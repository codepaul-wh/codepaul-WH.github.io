(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{384:function(t,a,e){"use strict";e.r(a);var s=e(26),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"spring-boot启动执行器：生产就绪功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot启动执行器：生产就绪功能"}},[t._v("#")]),t._v(" Spring Boot启动执行器：生产就绪功能")]),t._v(" "),e("p",[t._v("Spring Boot包含许多其他功能，可帮助您在将应用程序投入生产时监控和管理您的应用程序。您可以选择使用HTTP端点或JMX管理和监视您的应用程序。审核，运行状况和指标收集也可以自动应用于您的应用程序。")]),t._v(" "),e("h2",{attrs:{id:"_1-启用生产就绪功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-启用生产就绪功能"}},[t._v("#")]),t._v(" 1.启用生产就绪功能")]),t._v(" "),e("p",[t._v("该"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("spring-boot-actuator")]),e("OutboundLink")],1),t._v("模块提供了Spring Boot生产就绪的所有功能。启用功能的最简单方法是向"),e("code",[t._v("spring-boot-starter-actuator")]),t._v("“启动器” 添加依赖项。")]),t._v(" "),e("p",[t._v("执行器的定义")]),t._v(" "),e("p",[t._v("致动器是制造术语，是指用于移动或控制某些物体的机械设备。执行器可以通过很小的变化产生大量的运动。")]),t._v(" "),e("p",[t._v("要将执行器添加到基于Maven的项目中，请添加以下“ Starter”依赖项：")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-actuator"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("对于Gradle，请使用以下声明：")]),t._v(" "),e("div",{staticClass:"language-groovy extra-class"},[e("pre",{pre:!0,attrs:{class:"language-groovy"}},[e("code",[t._v("dependencies "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"org.springframework.boot:spring-boot-starter-actuator"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"_2-端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-端点"}},[t._v("#")]),t._v(" 2.端点")]),t._v(" "),e("p",[t._v("执行器端点使您可以监视应用程序并与之交互。Spring Boot包含许多内置端点，您可以添加自己的端点。例如，"),e("code",[t._v("health")]),t._v("端点提供基本的应用程序运行状况信息。")]),t._v(" "),e("p",[t._v("每个端点都可以"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-enabling-endpoints",target:"_blank",rel:"noopener noreferrer"}},[t._v("启用或禁用"),e("OutboundLink")],1),t._v("。这控制了是否创建了端点以及它的bean在应用程序上下文中是否存在。为了可以远程访问，端点还必须"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-exposing-endpoints",target:"_blank",rel:"noopener noreferrer"}},[t._v("通过JMX或HTTP公开"),e("OutboundLink")],1),t._v("。大多数应用程序选择HTTP，其中终结点的ID和前缀"),e("code",[t._v("/actuator")]),t._v("映射到URL。例如，默认情况下，"),e("code",[t._v("health")]),t._v("端点映射到"),e("code",[t._v("/actuator/health")]),t._v("。")]),t._v(" "),e("p",[t._v("可以使用以下与技术无关的端点：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("ID")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("auditevents")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("公开当前应用程序的审核事件信息。需要一个"),e("code",[t._v("AuditEventRepository")]),t._v("豆。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("beans")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示应用程序中所有Spring Bean的完整列表。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("caches")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("公开可用的缓存。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("conditions")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示在配置和自动配置类上评估的条件以及它们匹配或不匹配的原因。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("configprops")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示所有的整理列表"),e("code",[t._v("@ConfigurationProperties")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("env")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("公开Spring的属性"),e("code",[t._v("ConfigurableEnvironment")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("flyway")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示已应用的所有Flyway数据库迁移。需要一个或多个"),e("code",[t._v("Flyway")]),t._v("豆。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("health")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示应用程序运行状况信息。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("httptrace")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示HTTP跟踪信息（默认情况下，最近100个HTTP请求-响应交换）。需要一个"),e("code",[t._v("HttpTraceRepository")]),t._v("豆。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("info")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示任意应用程序信息。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("integrationgraph")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示Spring Integration图。需要对的依赖"),e("code",[t._v("spring-integration-core")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("loggers")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示和修改应用程序中记录器的配置。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("liquibase")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示已应用的所有Liquibase数据库迁移。需要一个或多个"),e("code",[t._v("Liquibase")]),t._v("豆。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("metrics")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示当前应用程序的“指标”信息。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("mappings")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示所有"),e("code",[t._v("@RequestMapping")]),t._v("路径的整理列表。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("scheduledtasks")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("显示应用程序中的计划任务。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("sessions")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("允许从Spring Session支持的会话存储中检索和删除用户会话。需要使用Spring Session的基于Servlet的Web应用程序。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("shutdown")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("使应用程序正常关闭。默认禁用。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("threaddump")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("执行线程转储。")])])])]),t._v(" "),e("p",[t._v("如果您的应用程序是Web应用程序（Spring MVC，Spring WebFlux或Jersey），则可以使用以下附加端点：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("ID")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("heapdump")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回"),e("code",[t._v("hprof")]),t._v("堆转储文件。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("jolokia")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("通过HTTP公开JMX bean（当Jolokia在类路径上时，不适用于WebFlux）。需要对的依赖"),e("code",[t._v("jolokia-core")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("logfile")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("返回日志文件的内容（如果已设置"),e("code",[t._v("logging.file.name")]),t._v("或"),e("code",[t._v("logging.file.path")]),t._v("属性）。支持使用HTTP "),e("code",[t._v("Range")]),t._v("标头来检索部分日志文件的内容。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("prometheus")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以Prometheus服务器可以抓取的格式公开指标。需要对的依赖"),e("code",[t._v("micrometer-registry-prometheus")]),t._v("。")])])])]),t._v(" "),e("p",[t._v("要了解有关执行器端点及其请求和响应格式的更多信息，请参阅单独的API文档（"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/actuator-api//html/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML"),e("OutboundLink")],1),t._v("或"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/actuator-api//pdf/spring-boot-actuator-web-api.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("PDF"),e("OutboundLink")],1),t._v("）。")]),t._v(" "),e("h3",{attrs:{id:"_2-1。启用端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1。启用端点"}},[t._v("#")]),t._v(" 2.1。启用端点")]),t._v(" "),e("p",[t._v("默认情况下，所有端点"),e("code",[t._v("shutdown")]),t._v("均处于启用状态。要配置端点的启用，请使用其"),e("code",[t._v("management.endpoint.<id>.enabled")]),t._v("属性。以下示例启用"),e("code",[t._v("shutdown")]),t._v("端点：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.shutdown.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])]),e("p",[t._v("如果您希望启用端点启用而不是退出启用，请将该"),e("code",[t._v("management.endpoints.enabled-by-default")]),t._v("属性设置为，"),e("code",[t._v("false")]),t._v("并使用各个端点"),e("code",[t._v("enabled")]),t._v("属性重新启用。以下示例启用该"),e("code",[t._v("info")]),t._v("端点并禁用所有其他端点：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.enabled-by-default")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.info.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("禁用的端点将从应用程序上下文中完全删除。如果只想更改公开端点的技术，请使用"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-exposing-endpoints",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("include")]),t._v("和"),e("code",[t._v("exclude")]),t._v("属性"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("h3",{attrs:{id:"_2-2。暴露端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2。暴露端点"}},[t._v("#")]),t._v(" 2.2。暴露端点")]),t._v(" "),e("p",[t._v("由于端点可能包含敏感信息，因此应谨慎考虑何时公开它们。下表显示了内置端点的默认暴露：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("ID")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("JMX")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("网页")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("auditevents")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("beans")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("caches")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("conditions")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("configprops")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("env")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("flyway")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("health")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("heapdump")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("不适用")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("httptrace")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("info")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("integrationgraph")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("jolokia")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("不适用")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("logfile")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("不适用")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("loggers")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("liquibase")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("metrics")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("mappings")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("prometheus")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("不适用")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("scheduledtasks")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("sessions")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("shutdown")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("threaddump")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("没有")])])])]),t._v(" "),e("p",[t._v("到端点暴露的变化，使用下面的特定技术"),e("code",[t._v("include")]),t._v("和"),e("code",[t._v("exclude")]),t._v("特性：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("默认")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.endpoints.jmx.exposure.exclude")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.endpoints.jmx.exposure.include")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("*")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.endpoints.web.exposure.exclude")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.endpoints.web.exposure.include")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("info, health")])])])])]),t._v(" "),e("p",[t._v("该"),e("code",[t._v("include")]),t._v("属性列出了公开的端点的ID。该"),e("code",[t._v("exclude")]),t._v("属性列出了不应公开的端点的ID。该"),e("code",[t._v("exclude")]),t._v("属性优先于该"),e("code",[t._v("include")]),t._v("属性。无论"),e("code",[t._v("include")]),t._v("和"),e("code",[t._v("exclude")]),t._v("性能可与端点ID列表进行配置。")]),t._v(" "),e("p",[t._v("例如，要停止通过JMX公开所有端点，而仅公开"),e("code",[t._v("health")]),t._v("和"),e("code",[t._v("info")]),t._v("端点，请使用以下属性：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.jmx.exposure.include")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("health,info")]),t._v("\n")])])]),e("p",[e("code",[t._v("*")]),t._v("可用于选择所有端点。例如，要通过HTTP公开除"),e("code",[t._v("env")]),t._v("和"),e("code",[t._v("beans")]),t._v("端点之外的所有内容，请使用以下属性：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.exposure.include")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("*")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.exposure.exclude")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("env,beans")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[e("code",[t._v("*")]),t._v(" 在YAML中有特殊含义，因此，如果要包括（或排除）所有端点，请确保添加引号，如以下示例所示："),e("code",[t._v('management: endpoints: web: exposure: include: "*"')])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果您的应用程序公开公开，我们强烈建议您也"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-security",target:"_blank",rel:"noopener noreferrer"}},[t._v("保护端点"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果要实现暴露端点的自己的策略，则可以注册"),e("code",[t._v("EndpointFilter")]),t._v("Bean。")])]),t._v(" "),e("h3",{attrs:{id:"_2-3。保护http端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3。保护http端点"}},[t._v("#")]),t._v(" 2.3。保护HTTP端点")]),t._v(" "),e("p",[t._v("您应该像对待其他任何敏感URL一样，小心保护HTTP端点的安全。如果存在Spring Security，则默认情况下使用Spring Security的内容协商策略来保护端点安全。例如，如果您希望为HTTP端点配置自定义安全性，只允许具有特定角色的用户访问它们，Spring Boot提供了一些方便的"),e("code",[t._v("RequestMatcher")]),t._v("对象，可以将它们与Spring Security结合使用。")]),t._v(" "),e("p",[t._v("典型的Spring Security配置可能类似于以下示例：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxyBeanMethods "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActuatorSecurity")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSecurityConfigurerAdapter")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpSecurity")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestMatcher")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EndpointRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toAnyEndpoint")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("authorizeRequests")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n                requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("anyRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasRole")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ENDPOINT_ADMIN"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpBasic")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("前面的示例用于"),e("code",[t._v("EndpointRequest.toAnyEndpoint()")]),t._v("将请求匹配到任何端点，然后确保所有"),e("code",[t._v("ENDPOINT_ADMIN")]),t._v("角色都具有该角色。上还有其他几种匹配器方法"),e("code",[t._v("EndpointRequest")]),t._v("。有关详细信息，请参见API文档（"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/actuator-api//html",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML"),e("OutboundLink")],1),t._v("或"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/actuator-api//pdf/spring-boot-actuator-web-api.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("PDF"),e("OutboundLink")],1),t._v("）。")]),t._v(" "),e("p",[t._v("如果将应用程序部署在防火墙后面，则可能希望无需进行身份验证即可访问所有执行器端点。您可以通过更改"),e("code",[t._v("management.endpoints.web.exposure.include")]),t._v("属性来做到这一点，如下所示：")]),t._v(" "),e("p",[t._v("application.properties")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.exposure.include")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("*")]),t._v("\n")])])]),e("p",[t._v("此外，如果存在Spring Security，则需要添加自定义安全配置，该配置允许未经身份验证的端点访问，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proxyBeanMethods "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActuatorSecurity")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSecurityConfigurerAdapter")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpSecurity")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestMatcher")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EndpointRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toAnyEndpoint")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("authorizeRequests")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n            requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("anyRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("permitAll")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"_2-4。配置端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4。配置端点"}},[t._v("#")]),t._v(" 2.4。配置端点")]),t._v(" "),e("p",[t._v("端点自动缓存对不带任何参数的读取操作的响应。要配置端点缓存响应的时间，请使用其"),e("code",[t._v("cache.time-to-live")]),t._v("属性。以下示例将"),e("code",[t._v("beans")]),t._v("端点的缓存的生存时间设置为10秒：")]),t._v(" "),e("p",[t._v("application.properties")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.beans.cache.time-to-live")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("10s")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("该前缀"),e("code",[t._v("management.endpoint.<name>")]),t._v("用于唯一标识正在配置的端点。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("发出经过身份验证的HTTP请求时，"),e("code",[t._v("Principal")]),t._v("会将视为端点的输入，因此将不缓存响应。")])]),t._v(" "),e("h3",{attrs:{id:"_2-5。用于执行器web端点的超媒体"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5。用于执行器web端点的超媒体"}},[t._v("#")]),t._v(" 2.5。用于执行器Web端点的超媒体")]),t._v(" "),e("p",[t._v("添加了“发现页面”，其中包含指向所有端点的链接。"),e("code",[t._v("/actuator")]),t._v("默认情况下，“发现页面”可用。")]),t._v(" "),e("p",[t._v("配置了自定义管理上下文路径后，“发现页面”将自动从"),e("code",[t._v("/actuator")]),t._v("管理上下文的根目录移到。例如，如果管理上下文路径为"),e("code",[t._v("/management")]),t._v("，则发现页面可从访问"),e("code",[t._v("/management")]),t._v("。将管理上下文路径设置为时"),e("code",[t._v("/")]),t._v("，将禁用发现页面，以防止与其他映射发生冲突的可能性。")]),t._v(" "),e("h3",{attrs:{id:"_2-6。cors支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-6。cors支持"}},[t._v("#")]),t._v(" 2.6。CORS支持")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing",target:"_blank",rel:"noopener noreferrer"}},[t._v("跨域资源共享"),e("OutboundLink")],1),t._v("（CORS）是"),e("a",{attrs:{href:"https://www.w3.org/TR/cors/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C规范"),e("OutboundLink")],1),t._v("，使您可以灵活地指定授权哪种类型的跨域请求。如果使用Spring MVC或Spring WebFlux，则可以将Actuator的Web端点配置为支持此类方案。")]),t._v(" "),e("p",[t._v("默认情况下，CORS支持是禁用的，并且仅"),e("code",[t._v("management.endpoints.web.cors.allowed-origins")]),t._v("在设置属性后才启用。以下配置允许"),e("code",[t._v("GET")]),t._v("和"),e("code",[t._v("POST")]),t._v("从"),e("code",[t._v("example.com")]),t._v("域调用：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.cors.allowed-origins")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("https://example.com")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.cors.allowed-methods")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("GET,POST")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("有关选项的完整列表，请参见"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/endpoint/web/CorsEndpointProperties.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("CorsEndpointProperties"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("h3",{attrs:{id:"_2-7。实施自定义端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7。实施自定义端点"}},[t._v("#")]),t._v(" 2.7。实施自定义端点")]),t._v(" "),e("p",[t._v("如果添加带有的"),e("code",[t._v("@Bean")]),t._v("注释"),e("code",[t._v("@Endpoint")]),t._v("，则带"),e("code",[t._v("@ReadOperation")]),t._v("，"),e("code",[t._v("@WriteOperation")]),t._v("或注释的任何方法"),e("code",[t._v("@DeleteOperation")]),t._v("都将通过JMX以及Web应用程序中的HTTP自动公开。可以使用Jersey，Spring MVC或Spring WebFlux通过HTTP公开端点。如果同时提供Jersey和Spring MVC，将使用Spring MVC。")]),t._v(" "),e("p",[t._v("您也可以使用"),e("code",[t._v("@JmxEndpoint")]),t._v("或编写技术特定的端点"),e("code",[t._v("@WebEndpoint")]),t._v("。这些端点仅限于各自的技术。例如，"),e("code",[t._v("@WebEndpoint")]),t._v("仅通过HTTP而不是JMX公开。")]),t._v(" "),e("p",[t._v("您可以使用"),e("code",[t._v("@EndpointWebExtension")]),t._v("和编写特定于技术的扩展"),e("code",[t._v("@EndpointJmxExtension")]),t._v("。这些注释使您可以提供特定于技术的操作来扩展现有端点。")]),t._v(" "),e("p",[t._v("最后，如果需要访问特定于Web框架的功能，则可以实现Servlet或Spring "),e("code",[t._v("@Controller")]),t._v("和"),e("code",[t._v("@RestController")]),t._v("终结点，但要付出代价，即它们无法通过JMX或使用其他Web框架使用。")]),t._v(" "),e("h4",{attrs:{id:"_2-7-1。接收输入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-1。接收输入"}},[t._v("#")]),t._v(" 2.7.1。接收输入")]),t._v(" "),e("p",[t._v("端点上的操作通过其参数接收输入。通过网络公开时，这些参数的值取自URL的查询参数和JSON请求正文。通过JMX公开时，参数将映射到MBean操作的参数。默认情况下，参数是必需的。可以通过使用注释使它们成为可选的"),e("code",[t._v("@org.springframework.lang.Nullable")]),t._v("。")]),t._v(" "),e("p",[t._v("JSON请求正文中的每个根属性都可以映射到端点的参数。考虑以下JSON请求正文：")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"counter"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("这可用于调用带有"),e("code",[t._v("String name")]),t._v("和"),e("code",[t._v("int counter")]),t._v("参数的写操作。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("由于端点与技术无关，因此只能在方法签名中指定简单类型。特别是，不支持使用定义了"),e("code",[t._v("name")]),t._v("和"),e("code",[t._v("counter")]),t._v("属性的自定义类型声明单个参数。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("为了将输入映射到操作方法的参数，应使用编译实现端点的Java代码"),e("code",[t._v("-parameters")]),t._v("，并用编译实现端点的Kotlin代码"),e("code",[t._v("-java-parameters")]),t._v("。如果您使用的是Spring Boot的Gradle插件，或者您使用的是Maven和，则此操作将自动发生"),e("code",[t._v("spring-boot-starter-parent")]),t._v("。")])]),t._v(" "),e("h5",{attrs:{id:"输入类型转换"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#输入类型转换"}},[t._v("#")]),t._v(" 输入类型转换")]),t._v(" "),e("p",[t._v("如有必要，传递给端点操作方法的参数会自动转换为所需的类型。在调用操作方法之前，通过JMX或HTTP请求接收到的输入将使用的实例"),e("code",[t._v("ApplicationConversionService")]),t._v("以及任何"),e("code",[t._v("Converter")]),t._v("或"),e("code",[t._v("GenericConverter")]),t._v("限定为的Bean 转换为所需的类型"),e("code",[t._v("@EndpointConverter")]),t._v("。")]),t._v(" "),e("h4",{attrs:{id:"_2-7-2。自定义web端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-2。自定义web端点"}},[t._v("#")]),t._v(" 2.7.2。自定义Web端点")]),t._v(" "),e("p",[t._v("上的操作"),e("code",[t._v("@Endpoint")]),t._v("，"),e("code",[t._v("@WebEndpoint")]),t._v("或者"),e("code",[t._v("@EndpointWebExtension")]),t._v("使用新泽西州，Spring MVC的，或Spring WebFlux自动曝光通过HTTP。如果同时提供Jersey和Spring MVC，将使用Spring MVC。")]),t._v(" "),e("h5",{attrs:{id:"web端点请求谓词"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web端点请求谓词"}},[t._v("#")]),t._v(" Web端点请求谓词")]),t._v(" "),e("p",[t._v("对于在暴露于Web的端点上的每个操作，都会自动生成一个请求谓词。")]),t._v(" "),e("h5",{attrs:{id:"路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#路径"}},[t._v("#")]),t._v(" 路径")]),t._v(" "),e("p",[t._v("谓词的路径由终结点的ID和暴露于Web的终结点的基本路径确定。默认基本路径为"),e("code",[t._v("/actuator")]),t._v("。例如，具有ID的端点"),e("code",[t._v("sessions")]),t._v("将"),e("code",[t._v("/actuator/sessions")]),t._v("用作谓词中的路径。")]),t._v(" "),e("p",[t._v("通过使用注释操作方法的一个或多个参数，可以进一步自定义路径"),e("code",[t._v("@Selector")]),t._v("。这样的参数作为路径变量添加到路径谓词。当端点操作被调用时，变量的值被传递到操作方法中。如果要捕获所有剩余的路径元素，则可以添加"),e("code",[t._v("@Selector(Match=ALL_REMAINING)")]),t._v("到最后一个参数，并将其设置为与转换兼容的类型"),e("code",[t._v("String[]")]),t._v("。")]),t._v(" "),e("h5",{attrs:{id:"http方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http方法"}},[t._v("#")]),t._v(" HTTP方法")]),t._v(" "),e("p",[t._v("谓词的HTTP方法由操作类型决定，如下表所示：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("运作方式")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("HTTP方法")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("@ReadOperation")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("GET")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("@WriteOperation")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("POST")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("@DeleteOperation")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("DELETE")])])])])]),t._v(" "),e("h5",{attrs:{id:"消耗"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消耗"}},[t._v("#")]),t._v(" 消耗")]),t._v(" "),e("p",[t._v("对于使用请求正文的"),e("code",[t._v("@WriteOperation")]),t._v("（HTTP "),e("code",[t._v("POST")]),t._v("），谓词的消耗子句为"),e("code",[t._v("application/vnd.spring-boot.actuator.v2+json, application/json")]),t._v("。对于所有其他操作，消耗子句为空。")]),t._v(" "),e("h5",{attrs:{id:"产生"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#产生"}},[t._v("#")]),t._v(" 产生")]),t._v(" "),e("p",[t._v("的产生谓词子句可以由被确定"),e("code",[t._v("produces")]),t._v("的属性"),e("code",[t._v("@DeleteOperation")]),t._v("，"),e("code",[t._v("@ReadOperation")]),t._v("和"),e("code",[t._v("@WriteOperation")]),t._v("注解。该属性是可选的。如果未使用，则会自动确定produces子句。")]),t._v(" "),e("p",[t._v("如果操作方法返回"),e("code",[t._v("void")]),t._v("或"),e("code",[t._v("Void")]),t._v("生产子句为空。如果操作方法返回a "),e("code",[t._v("org.springframework.core.io.Resource")]),t._v("，则Produces子句为"),e("code",[t._v("application/octet-stream")]),t._v("。对于所有其他操作，produces子句为"),e("code",[t._v("application/vnd.spring-boot.actuator.v2+json, application/json")]),t._v("。")]),t._v(" "),e("h5",{attrs:{id:"web端点响应状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web端点响应状态"}},[t._v("#")]),t._v(" Web端点响应状态")]),t._v(" "),e("p",[t._v("端点操作的默认响应状态取决于操作类型（读，写或删除）以及该操作返回的内容（如果有）。")]),t._v(" "),e("p",[t._v("A "),e("code",[t._v("@ReadOperation")]),t._v("返回一个值，响应状态将为200（确定）。如果未返回值，则响应状态将为404（未找到）。")]),t._v(" "),e("p",[t._v("如果a "),e("code",[t._v("@WriteOperation")]),t._v("或"),e("code",[t._v("@DeleteOperation")]),t._v("返回值，则响应状态将为200（确定）。如果未返回值，则响应状态将为204（无内容）。")]),t._v(" "),e("p",[t._v("如果在没有必需参数或无法将参数转换为必需类型的参数的情况下调用操作，则不会调用该操作方法，并且响应状态将为400（错误请求）。")]),t._v(" "),e("h5",{attrs:{id:"web端点范围请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web端点范围请求"}},[t._v("#")]),t._v(" Web端点范围请求")]),t._v(" "),e("p",[t._v("HTTP范围请求可用于请求HTTP资源的一部分。使用Spring MVC或Spring Web Flux时，返回"),e("code",[t._v("org.springframework.core.io.Resource")]),t._v("自动支持范围请求的操作。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("使用Jersey时，范围请求不受支持。")])]),t._v(" "),e("h5",{attrs:{id:"web端点安全"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web端点安全"}},[t._v("#")]),t._v(" Web端点安全")]),t._v(" "),e("p",[t._v("Web终结点或特定于Web的终结点扩展上的操作可以接收当前参数"),e("code",[t._v("java.security.Principal")]),t._v("或"),e("code",[t._v("org.springframework.boot.actuate.endpoint.SecurityContext")]),t._v("方法参数。前者通常与结合使用"),e("code",[t._v("@Nullable")]),t._v("，以为经过身份验证和未经身份验证的用户提供不同的行为。后者通常用于使用其"),e("code",[t._v("isUserInRole(String)")]),t._v("方法执行授权检查。")]),t._v(" "),e("h4",{attrs:{id:"_2-7-3。servlet端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-3。servlet端点"}},[t._v("#")]),t._v(" 2.7.3。Servlet端点")]),t._v(" "),e("p",[e("code",[t._v("Servlet")]),t._v("可以通过实现一个"),e("code",[t._v("@ServletEndpoint")]),t._v("也带有的类来将A 公开为端点"),e("code",[t._v("Supplier<EndpointServlet>")]),t._v("。Servlet端点提供与Servlet容器的更深层集成，但以可移植性为代价。它们旨在用于将现有对象公开"),e("code",[t._v("Servlet")]),t._v("为端点。对于新端点，应尽可能使用"),e("code",[t._v("@Endpoint")]),t._v("和"),e("code",[t._v("@WebEndpoint")]),t._v("注释。")]),t._v(" "),e("h4",{attrs:{id:"_2-7-4。控制器端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-4。控制器端点"}},[t._v("#")]),t._v(" 2.7.4。控制器端点")]),t._v(" "),e("p",[e("code",[t._v("@ControllerEndpoint")]),t._v("并且"),e("code",[t._v("@RestControllerEndpoint")]),t._v("可以用于实现仅由Spring MVC或Spring WebFlux公开的端点。使用Spring MVC和Spring WebFlux的标准注释（例如"),e("code",[t._v("@RequestMapping")]),t._v("和）映射方法"),e("code",[t._v("@GetMapping")]),t._v("，并将端点的ID用作路径的前缀。控制器端点提供了与Spring Web框架的更深层集成，但以可移植性为代价。的"),e("code",[t._v("@Endpoint")]),t._v("和"),e("code",[t._v("@WebEndpoint")]),t._v("注解应当优选只要有可能。")]),t._v(" "),e("h3",{attrs:{id:"_2-8。健康资讯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8。健康资讯"}},[t._v("#")]),t._v(" 2.8。健康资讯")]),t._v(" "),e("p",[t._v("您可以使用运行状况信息来检查正在运行的应用程序的状态。监视软件通常使用它在生产系统出现故障时向某人发出警报。"),e("code",[t._v("health")]),t._v("端点公开的信息取决于"),e("code",[t._v("management.endpoint.health.show-details")]),t._v("和"),e("code",[t._v("management.endpoint.health.show-components")]),t._v("属性，可以使用以下值之一对其进行配置：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("never")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("详细信息永远不会显示。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("when-authorized")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("详细信息仅显示给授权用户。可以使用来配置授权角色"),e("code",[t._v("management.endpoint.health.roles")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("always")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("向所有用户显示详细信息。")])])])]),t._v(" "),e("p",[t._v("默认值为"),e("code",[t._v("never")]),t._v("。当用户担任一个或多个端点的角色时，该用户被视为已授权。如果端点没有配置的角色（默认值），则所有通过身份验证的用户均被视为已授权。可以使用"),e("code",[t._v("management.endpoint.health.roles")]),t._v("属性配置角色。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果您已保护应用程序安全并希望使用"),e("code",[t._v("always")]),t._v("，则安全配置必须允许经过身份验证的用户和未经身份验证的用户都可以访问运行状况端点。")])]),t._v(" "),e("p",[t._v("运行状况信息是从中收集的"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributorRegistry.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("HealthContributorRegistry")]),e("OutboundLink")],1),t._v("（默认情况"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("HealthContributor")]),e("OutboundLink")],1),t._v("下，您的中定义的所有实例"),e("code",[t._v("ApplicationContext")]),t._v("）。Spring Boot包括许多自动配置的"),e("code",[t._v("HealthContributors")]),t._v("，您也可以编写自己的。")]),t._v(" "),e("p",[t._v("A "),e("code",[t._v("HealthContributor")]),t._v("可以是a "),e("code",[t._v("HealthIndicator")]),t._v("或a "),e("code",[t._v("CompositeHealthContributor")]),t._v("。A "),e("code",[t._v("HealthIndicator")]),t._v("提供实际的健康信息，包括"),e("code",[t._v("Status")]),t._v("。A "),e("code",[t._v("CompositeHealthContributor")]),t._v("提供其他的组合"),e("code",[t._v("HealthContributors")]),t._v("。合起来，贡献者形成一个树形结构来代表整个系统的健康状况。")]),t._v(" "),e("p",[t._v("默认情况下，最终的系统健康状况由派生，"),e("code",[t._v("StatusAggregator")]),t._v("后者根据状态"),e("code",[t._v("HealthIndicator")]),t._v("的有序列表对每个状态进行排序。排序列表中的第一个状态用作整体健康状态。如果没有"),e("code",[t._v("HealthIndicator")]),t._v("返回一个已知状态"),e("code",[t._v("StatusAggregator")]),t._v("，一种"),e("code",[t._v("UNKNOWN")]),t._v("是使用状态。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("该"),e("code",[t._v("HealthContributorRegistry")]),t._v("可用于在运行时注册和注销的健康指标。")])]),t._v(" "),e("h4",{attrs:{id:"_2-8-1。自动配置的健康指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-1。自动配置的健康指标"}},[t._v("#")]),t._v(" 2.8.1。自动配置的健康指标")]),t._v(" "),e("p",[e("code",[t._v("HealthIndicators")]),t._v("适当时，Spring Boot会自动配置以下内容：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("CassandraHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Cassandra数据库是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("CouchbaseHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Couchbase群集是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/system/DiskSpaceHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("DiskSpaceHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查磁盘空间不足。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/elasticsearch/ElasticSearchRestHealthContributorAutoConfiguration.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ElasticSearchRestHealthContributorAutoConfiguration")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Elasticsearch集群是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/hazelcast/HazelcastHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("HazelcastHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Hazelcast服务器是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/influx/InfluxDbHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("InfluxDbHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查InfluxDB服务器是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jms/JmsHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("JmsHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查JMS代理是否启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/ldap/LdapHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("LdapHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查LDAP服务器是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mail/MailHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("MailHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查邮件服务器是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mongo/MongoHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("MongoHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Mongo数据库是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Neo4jHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Neo4j数据库是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/PingHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("PingHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("一律以回应"),e("code",[t._v("UP")]),t._v("。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/amqp/RabbitHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("RabbitHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Rabbit服务器是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/redis/RedisHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("RedisHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Redis服务器是否启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/solr/SolrHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("SolrHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Solr服务器是否已启动。")])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("您可以通过设置"),e("code",[t._v("management.health.defaults.enabled")]),t._v("属性来全部禁用它们。")])]),t._v(" "),e("h4",{attrs:{id:"_2-8-2。编写自定义健康指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-2。编写自定义健康指标"}},[t._v("#")]),t._v(" 2.8.2。编写自定义健康指标")]),t._v(" "),e("p",[t._v("为了提供定制的健康信息，您可以注册实现该"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("HealthIndicator")]),e("OutboundLink")],1),t._v("接口的Spring bean 。您需要提供该"),e("code",[t._v("health()")]),t._v("方法的实现并返回"),e("code",[t._v("Health")]),t._v("响应。的"),e("code",[t._v("Health")]),t._v("响应应该包括一个状态，并且可以任选地包括另外的细节被显示。以下代码显示了示例"),e("code",[t._v("HealthIndicator")]),t._v("实现：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("actuate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("actuate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HealthIndicator")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stereotype")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyHealthIndicator")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HealthIndicator")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" errorCode "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("check")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// perform some specific health check")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errorCode "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("down")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("withDetail")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error Code"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errorCode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("up")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("给定的标识符"),e("code",[t._v("HealthIndicator")]),t._v("是不带"),e("code",[t._v("HealthIndicator")]),t._v("后缀的Bean的名称（如果存在）。在前面的示例中，健康信息在名为的条目中可用"),e("code",[t._v("my")]),t._v("。")])]),t._v(" "),e("p",[t._v("除了Spring Boot的预定义"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/Status.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Status")]),e("OutboundLink")],1),t._v("类型之外，还可以"),e("code",[t._v("Health")]),t._v("返回"),e("code",[t._v("Status")]),t._v("代表新系统状态的自定义。在这种情况下，"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/StatusAggregator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("StatusAggregator")]),e("OutboundLink")],1),t._v("还需要提供接口的自定义实现，或者必须使用"),e("code",[t._v("management.endpoint.health.status.order")]),t._v("配置属性来配置默认实现。")]),t._v(" "),e("p",[t._v("例如，假设在您的一种实现中使用了"),e("code",[t._v("Status")]),t._v("带有代码的new 。要配置严重性顺序，请将以下属性添加到您的应用程序属性中："),e("code",[t._v("FATAL``HealthIndicator")])]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.status.order")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("fatal,down,out-of-service,unknown,up")]),t._v("\n")])])]),e("p",[t._v("在响应中的HTTP状态代码反映总体健康状况（例如，"),e("code",[t._v("UP")]),t._v("映射到200，而"),e("code",[t._v("OUT_OF_SERVICE")]),t._v("并"),e("code",[t._v("DOWN")]),t._v("映射到503）。如果通过HTTP访问运行状况终结点，则可能还需要注册自定义状态映射。例如，以下属性映射"),e("code",[t._v("FATAL")]),t._v("到503（服务不可用）：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.status.http-mapping.fatal")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("503")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果需要更多控制，则可以定义自己的"),e("code",[t._v("HttpCodeStatusMapper")]),t._v("bean。")])]),t._v(" "),e("p",[t._v("下表显示了内置状态的默认状态映射：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("状态")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("制图")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("下")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("SERVICE_UNAVAILABLE（503）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("中止服务")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("SERVICE_UNAVAILABLE（503）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("上")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认情况下没有映射，因此http状态为200")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("未知")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认情况下没有映射，因此http状态为200")])])])]),t._v(" "),e("h4",{attrs:{id:"_2-8-3。反应性健康指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-3。反应性健康指标"}},[t._v("#")]),t._v(" 2.8.3。反应性健康指标")]),t._v(" "),e("p",[t._v("对于反应式应用程序，例如使用Spring WebFlux的那些应用程序，"),e("code",[t._v("ReactiveHealthContributor")]),t._v("提供了无阻塞合同来获取应用程序的运行状况。与传统方法类似"),e("code",[t._v("HealthContributor")]),t._v("，健康信息是从的内容中收集的"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributorRegistry.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ReactiveHealthContributorRegistry")]),e("OutboundLink")],1),t._v("（默认情况下，所有信息"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("HealthContributor")]),e("OutboundLink")],1),t._v("和"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ReactiveHealthContributor")]),e("OutboundLink")],1),t._v("您定义的实例"),e("code",[t._v("ApplicationContext")]),t._v("）。"),e("code",[t._v("HealthContributors")]),t._v("在弹性调度程序上执行不检查反应式API的常规。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("在反应式应用程序中，The "),e("code",[t._v("ReactiveHealthContributorRegistry")]),t._v("可用于在运行时注册和注销健康指标。")])]),t._v(" "),e("p",[t._v("为了从反应式API提供自定义健康信息，您可以注册实现该"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ReactiveHealthIndicator")]),e("OutboundLink")],1),t._v("接口的Spring bean 。以下代码显示了示例"),e("code",[t._v("ReactiveHealthIndicator")]),t._v("实现：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyReactiveHealthIndicator")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReactiveHealthIndicator")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("doHealthCheck")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//perform some specific health check that returns a Mono<Health>")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onErrorResume")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ex "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("just")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Builder")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("down")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ex"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("要自动处理错误，请考虑从扩展"),e("code",[t._v("AbstractReactiveHealthIndicator")]),t._v("。")])]),t._v(" "),e("h4",{attrs:{id:"_2-8-4。自动配置的reactivehealthindicators"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-4。自动配置的reactivehealthindicators"}},[t._v("#")]),t._v(" 2.8.4。自动配置的ReactiveHealthIndicators")]),t._v(" "),e("p",[e("code",[t._v("ReactiveHealthIndicators")]),t._v("适当时，Spring Boot会自动配置以下内容：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraReactiveHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("CassandraReactiveHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Cassandra数据库是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseReactiveHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("CouchbaseReactiveHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Couchbase群集是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mongo/MongoReactiveHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("MongoReactiveHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Mongo数据库是否已启动。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/redis/RedisReactiveHealthIndicator.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("RedisReactiveHealthIndicator")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("检查Redis服务器是否启动。")])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如有必要，可用无功指示器代替常规指示器。此外，任何"),e("code",[t._v("HealthIndicator")]),t._v("未明确处理的内容都会自动包装。")])]),t._v(" "),e("h4",{attrs:{id:"_2-8-5。卫生团体"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-5。卫生团体"}},[t._v("#")]),t._v(" 2.8.5。卫生团体")]),t._v(" "),e("p",[t._v("有时将健康指标组织为可用于不同目的的组很有用。例如，如果将应用程序部署到Kubernetes，则可能需要一组不同的运行状况指示器来进行“活动”和“就绪”探针。")]),t._v(" "),e("p",[t._v("要创建运行状况指示器组，可以使用该"),e("code",[t._v("management.endpoint.health.group.<name>")]),t._v("属性并将运行状况指示器ID的列表指定为"),e("code",[t._v("include")]),t._v("或"),e("code",[t._v("exclude")]),t._v("。例如，要创建仅包含数据库指示符的组，可以定义以下内容：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.group.custom.include")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("db")]),t._v("\n")])])]),e("p",[t._v("然后，您可以点击来检查结果"),e("code",[t._v("localhost:8080/actuator/health/custom")]),t._v("。")]),t._v(" "),e("p",[t._v("默认情况下，集团将继承相同的"),e("code",[t._v("StatusAggregator")]),t._v("，并"),e("code",[t._v("HttpCodeStatusMapper")]),t._v("设置为系统运行状况，但是，这些也可以在每个组来定义。如果需要，也可以覆盖"),e("code",[t._v("show-details")]),t._v("和"),e("code",[t._v("roles")]),t._v("属性：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.group.custom.show-details")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("when-authorized")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.group.custom.roles")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("admin")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.group.custom.status.order")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("fatal,up")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.health.group.custom.status.http-mapping.fatal")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("500")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("您可以使用"),e("code",[t._v('@Qualifier("groupname")')]),t._v("，如果您需要注册自定义"),e("code",[t._v("StatusAggregator")]),t._v("或"),e("code",[t._v("HttpCodeStatusMapper")]),t._v("豆类用于与该组使用。")])]),t._v(" "),e("h3",{attrs:{id:"_2-9。应用信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9。应用信息"}},[t._v("#")]),t._v(" 2.9。应用信息")]),t._v(" "),e("p",[t._v("应用程序信息公开了从中"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("InfoContributor")]),e("OutboundLink")],1),t._v("定义的所有bean 收集的各种信息"),e("code",[t._v("ApplicationContext")]),t._v("。Spring Boot包含许多自动配置的"),e("code",[t._v("InfoContributor")]),t._v("bean，您可以编写自己的bean。")]),t._v(" "),e("h4",{attrs:{id:"_2-9-1。自动配置的信息贡献者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-1。自动配置的信息贡献者"}},[t._v("#")]),t._v(" 2.9.1。自动配置的信息贡献者")]),t._v(" "),e("p",[e("code",[t._v("InfoContributor")]),t._v("适当时，Spring Boot会自动配置以下bean：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("EnvironmentInfoContributor")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("从键"),e("code",[t._v("Environment")]),t._v("下方公开任何"),e("code",[t._v("info")]),t._v("键。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("GitInfoContributor")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如果"),e("code",[t._v("git.properties")]),t._v("文件可用，则公开git信息。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/BuildInfoContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("BuildInfoContributor")]),e("OutboundLink")],1)]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如果"),e("code",[t._v("META-INF/build-info.properties")]),t._v("文件可用，则公开构建信息。")])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("通过设置该"),e("code",[t._v("management.info.defaults.enabled")]),t._v("属性，可以全部禁用它们。")])]),t._v(" "),e("h4",{attrs:{id:"_2-9-2。定制应用信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-2。定制应用信息"}},[t._v("#")]),t._v(" 2.9.2。定制应用信息")]),t._v(" "),e("p",[t._v("您可以"),e("code",[t._v("info")]),t._v("通过设置"),e("code",[t._v("info.*")]),t._v("Spring属性来自定义端点公开的数据。键"),e("code",[t._v("Environment")]),t._v("下的所有属性"),e("code",[t._v("info")]),t._v("都将自动显示。例如，您可以将以下设置添加到"),e("code",[t._v("application.properties")]),t._v("文件中：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("info.app.encoding")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("UTF-8")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("info.app.java.source")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("1.8")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("info.app.java.target")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("1.8")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("除了对这些值进行硬编码之外，您还可以"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/howto.html#howto-automatic-expansion",target:"_blank",rel:"noopener noreferrer"}},[t._v("在构建时扩展info属性"),e("OutboundLink")],1),t._v("。假设您使用Maven，则可以按如下所示重写前面的示例："),e("code",[t._v("info.app.encoding=@project.build.sourceEncoding@ info.app.java.source=@java.version@ info.app.java.target=@java.version@")])])]),t._v(" "),e("h4",{attrs:{id:"_2-9-3。git提交信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-3。git提交信息"}},[t._v("#")]),t._v(" 2.9.3。Git提交信息")]),t._v(" "),e("p",[e("code",[t._v("info")]),t._v("端点的另一个有用的功能是它能够"),e("code",[t._v("git")]),t._v("在构建项目时发布有关源代码存储库状态的信息。如果"),e("code",[t._v("GitProperties")]),t._v("豆可用，"),e("code",[t._v("git.branch")]),t._v("，"),e("code",[t._v("git.commit.id")]),t._v("，和"),e("code",[t._v("git.commit.time")]),t._v("属性暴露出来。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("一个"),e("code",[t._v("GitProperties")]),t._v("bean是自动配置，如果一个"),e("code",[t._v("git.properties")]),t._v("文件可在classpath的根目录。有关更多详细"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/howto.html#howto-git-info",target:"_blank",rel:"noopener noreferrer"}},[t._v("信息，"),e("OutboundLink")],1),t._v("请参见“ "),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/howto.html#howto-git-info",target:"_blank",rel:"noopener noreferrer"}},[t._v("生成git信息"),e("OutboundLink")],1),t._v(" ”。")])]),t._v(" "),e("p",[t._v("如果要显示完整的git信息（即的完整内容"),e("code",[t._v("git.properties")]),t._v("），请使用"),e("code",[t._v("management.info.git.mode")]),t._v("属性，如下所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.info.git.mode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("full")]),t._v("\n")])])]),e("h4",{attrs:{id:"_2-9-4。建造信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-4。建造信息"}},[t._v("#")]),t._v(" 2.9.4。建造信息")]),t._v(" "),e("p",[t._v("如果有"),e("code",[t._v("BuildProperties")]),t._v("可用的bean，则"),e("code",[t._v("info")]),t._v("端点也可以发布有关构建的信息。如果"),e("code",[t._v("META-INF/build-info.properties")]),t._v("文件在类路径中可用，则会发生这种情况。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Maven和Gradle插件都可以生成该文件。有关更多详细"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/howto.html#howto-build-info",target:"_blank",rel:"noopener noreferrer"}},[t._v("信息，"),e("OutboundLink")],1),t._v("请参见“ "),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/howto.html#howto-build-info",target:"_blank",rel:"noopener noreferrer"}},[t._v("生成构建信息"),e("OutboundLink")],1),t._v(" ”。")])]),t._v(" "),e("h4",{attrs:{id:"_2-9-5。编写自定义信息贡献者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-5。编写自定义信息贡献者"}},[t._v("#")]),t._v(" 2.9.5。编写自定义信息贡献者")]),t._v(" "),e("p",[t._v("为了提供定制的应用程序信息，您可以注册实现该"),e("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/tree/v2.2.2.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("InfoContributor")]),e("OutboundLink")],1),t._v("接口的Spring bean 。")]),t._v(" "),e("p",[t._v("以下示例"),e("code",[t._v("example")]),t._v("使用单个值贡献一个条目：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("actuate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("actuate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InfoContributor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stereotype")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExampleInfoContributor")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InfoContributor")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("contribute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Builder")]),t._v(" builder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        builder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("withDetail")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("singletonMap")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("如果到达"),e("code",[t._v("info")]),t._v("端点，则应该看到包含以下附加条目的响应：")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"example"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"_3-通过http进行监视和管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-通过http进行监视和管理"}},[t._v("#")]),t._v(" 3.通过HTTP进行监视和管理")]),t._v(" "),e("p",[t._v("如果您正在开发Web应用程序，则Spring Boot Actuator会自动配置所有启用的端点以通过HTTP公开。默认约定是使用"),e("code",[t._v("id")]),t._v("前缀为的端点的"),e("code",[t._v("/actuator")]),t._v("作为URL路径。例如，"),e("code",[t._v("health")]),t._v("暴露为"),e("code",[t._v("/actuator/health")]),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Spring MVC，Spring WebFlux和Jersey本身支持Actuator。如果同时提供Jersey和Spring MVC，将使用Spring MVC。")])]),t._v(" "),e("h3",{attrs:{id:"_3-1。自定义管理端点路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1。自定义管理端点路径"}},[t._v("#")]),t._v(" 3.1。自定义管理端点路径")]),t._v(" "),e("p",[t._v("有时，自定义管理端点的前缀很有用。例如，您的应用程序可能已经"),e("code",[t._v("/actuator")]),t._v("用于其他用途。您可以使用该"),e("code",[t._v("management.endpoints.web.base-path")]),t._v("属性来更改管理端点的前缀，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.base-path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/manage")]),t._v("\n")])])]),e("p",[t._v("前面的"),e("code",[t._v("application.properties")]),t._v("示例将端点从更改"),e("code",[t._v("/actuator/{id}")]),t._v("为"),e("code",[t._v("/manage/{id}")]),t._v("（例如"),e("code",[t._v("/manage/info")]),t._v("）。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("除非管理端口已经被配置为"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-customizing-management-server-port",target:"_blank",rel:"noopener noreferrer"}},[t._v("通过使用不同的HTTP端口暴露端点"),e("OutboundLink")],1),t._v("，"),e("code",[t._v("management.endpoints.web.base-path")]),t._v("相对于"),e("code",[t._v("server.servlet.context-path")]),t._v("。如果"),e("code",[t._v("management.server.port")]),t._v("已配置，"),e("code",[t._v("management.endpoints.web.base-path")]),t._v("则相对于"),e("code",[t._v("management.server.servlet.context-path")]),t._v("。")])]),t._v(" "),e("p",[t._v("如果要将端点映射到其他路径，则可以使用该"),e("code",[t._v("management.endpoints.web.path-mapping")]),t._v("属性。")]),t._v(" "),e("p",[t._v("以下示例重新映射"),e("code",[t._v("/actuator/health")]),t._v("到"),e("code",[t._v("/healthcheck")]),t._v("：")]),t._v(" "),e("p",[t._v("application.properties")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.base-path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.path-mapping.health")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("healthcheck")]),t._v("\n")])])]),e("h3",{attrs:{id:"_3-2。自定义管理服务器端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2。自定义管理服务器端口"}},[t._v("#")]),t._v(" 3.2。自定义管理服务器端口")]),t._v(" "),e("p",[t._v("对于基于云的部署，通过使用默认的HTTP端口公开管理端点是明智的选择。但是，如果您的应用程序在自己的数据中心内运行，则您可能更喜欢使用其他HTTP端口公开端点。")]),t._v(" "),e("p",[t._v("您可以设置该"),e("code",[t._v("management.server.port")]),t._v("属性以更改HTTP端口，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8081")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("在Cloud Foundry上，默认情况下，应用程序仅在端口8080上接收HTTP和TCP路由请求。如果要在Cloud Foundry上使用自定义管理端口，则需要明确设置应用程序的路由以将流量转发到自定义端口。")])]),t._v(" "),e("h3",{attrs:{id:"_3-3。配置特定于管理的ssl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3。配置特定于管理的ssl"}},[t._v("#")]),t._v(" 3.3。配置特定于管理的SSL")]),t._v(" "),e("p",[t._v("当配置为使用自定义端口时，还可以通过使用各种"),e("code",[t._v("management.server.ssl.*")]),t._v("属性将管理服务器配置为其自己的SSL 。例如，这样做可以使管理服务器通过HTTP可用，而主应用程序使用HTTPS，如以下属性设置所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8443")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.key-store")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("classpath:store.jks")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.key-password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("secret")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8080")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.ssl.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("p",[t._v("或者，主服务器和管理服务器都可以使用SSL，但具有不同的密钥库，如下所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8443")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.key-store")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("classpath:main.jks")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("server.ssl.key-password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("secret")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8080")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.ssl.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.ssl.key-store")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("classpath:management.jks")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.ssl.key-password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("secret")]),t._v("\n")])])]),e("h3",{attrs:{id:"_3-4。自定义管理服务器地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4。自定义管理服务器地址"}},[t._v("#")]),t._v(" 3.4。自定义管理服务器地址")]),t._v(" "),e("p",[t._v("您可以通过设置"),e("code",[t._v("management.server.address")]),t._v("属性来自定义管理端点可用的地址。如果您只想在内部或面向操作的网络上侦听或仅侦听来自的连接，则这样做很有用"),e("code",[t._v("localhost")]),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("仅当端口与主服务器端口不同时，您才能在其他地址上侦听。")])]),t._v(" "),e("p",[t._v("以下示例"),e("code",[t._v("application.properties")]),t._v("不允许远程管理连接：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("8081")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("127.0.0.1")]),t._v("\n")])])]),e("h3",{attrs:{id:"_3-5。禁用http端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5。禁用http端点"}},[t._v("#")]),t._v(" 3.5。禁用HTTP端点")]),t._v(" "),e("p",[t._v("如果您不想通过HTTP公开端点，则可以将管理端口设置为"),e("code",[t._v("-1")]),t._v("，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.server.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("-1")]),t._v("\n")])])]),e("p",[t._v("也可以使用该"),e("code",[t._v("management.endpoints.web.exposure.exclude")]),t._v("属性来实现，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.web.exposure.exclude")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("*")]),t._v("\n")])])]),e("h2",{attrs:{id:"_4-通过jmx进行监视和管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-通过jmx进行监视和管理"}},[t._v("#")]),t._v(" 4.通过JMX进行监视和管理")]),t._v(" "),e("p",[t._v("Java管理扩展（JMX）提供了监视和管理应用程序的标准机制。默认情况下，不启用该功能，可以通过设置配置属性开启"),e("code",[t._v("spring.jmx.enabled")]),t._v("到"),e("code",[t._v("true")]),t._v("。"),e("code",[t._v("org.springframework.boot")]),t._v("默认情况下，Spring Boot将管理端点公开为域下的JMX MBean 。")]),t._v(" "),e("h3",{attrs:{id:"_4-1。自定义mbean名称"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1。自定义mbean名称"}},[t._v("#")]),t._v(" 4.1。自定义MBean名称")]),t._v(" "),e("p",[t._v("MBean的名称通常是从"),e("code",[t._v("id")]),t._v("端点的生成的。例如，"),e("code",[t._v("health")]),t._v("端点显示为"),e("code",[t._v("org.springframework.boot:type=Endpoint,name=Health")]),t._v("。")]),t._v(" "),e("p",[t._v("如果您的应用程序包含多个Spring "),e("code",[t._v("ApplicationContext")]),t._v("，则可能会发现名称冲突。要解决此问题，可以将"),e("code",[t._v("spring.jmx.unique-names")]),t._v("属性设置为，"),e("code",[t._v("true")]),t._v("以便MBean名称始终是唯一的。")]),t._v(" "),e("p",[t._v("您还可以自定义暴露端点的JMX域。以下设置显示了这样做的示例"),e("code",[t._v("application.properties")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("spring.jmx.unique-names")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.jmx.domain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("com.example.myapp")]),t._v("\n")])])]),e("h3",{attrs:{id:"_4-2。禁用jmx端点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2。禁用jmx端点"}},[t._v("#")]),t._v(" 4.2。禁用JMX端点")]),t._v(" "),e("p",[t._v("如果不想通过JMX公开端点，则可以将"),e("code",[t._v("management.endpoints.jmx.exposure.exclude")]),t._v("属性设置为"),e("code",[t._v("*")]),t._v("，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoints.jmx.exposure.exclude")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("*")]),t._v("\n")])])]),e("h3",{attrs:{id:"_4-3。通过http将jolokia用于jmx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3。通过http将jolokia用于jmx"}},[t._v("#")]),t._v(" 4.3。通过HTTP将Jolokia用于JMX")]),t._v(" "),e("p",[t._v("Jolokia是一个JMX-HTTP桥，它提供了另一种访问JMX bean的方法。要使用Jolokia，请包含的依赖项"),e("code",[t._v("org.jolokia:jolokia-core")]),t._v("。例如，使用Maven，您将添加以下依赖项：")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.jolokia"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("jolokia-core"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("然后可以通过添加"),e("code",[t._v("jolokia")]),t._v("或"),e("code",[t._v("*")]),t._v("向"),e("code",[t._v("management.endpoints.web.exposure.include")]),t._v("属性公开Jolokia端点。然后，您可以通过"),e("code",[t._v("/actuator/jolokia")]),t._v("在管理HTTP服务器上使用来访问它。")]),t._v(" "),e("h4",{attrs:{id:"_4-3-1。自定义jolokia"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1。自定义jolokia"}},[t._v("#")]),t._v(" 4.3.1。自定义Jolokia")]),t._v(" "),e("p",[t._v("Jolokia具有许多设置，这些设置通常是通过设置servlet参数进行配置的。通过Spring Boot，您可以使用您的"),e("code",[t._v("application.properties")]),t._v("文件。为此，请在参数"),e("code",[t._v("management.endpoint.jolokia.config.")]),t._v("前面加上，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.jolokia.config.debug")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])]),e("h4",{attrs:{id:"_4-3-2。禁用jolokia"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2。禁用jolokia"}},[t._v("#")]),t._v(" 4.3.2。禁用Jolokia")]),t._v(" "),e("p",[t._v("如果您使用Jolokia但不希望Spring Boot对其进行配置，请将该"),e("code",[t._v("management.endpoint.jolokia.enabled")]),t._v("属性设置为"),e("code",[t._v("false")]),t._v("，如下所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.endpoint.jolokia.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("h2",{attrs:{id:"_5-记录仪"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-记录仪"}},[t._v("#")]),t._v(" 5.记录仪")]),t._v(" "),e("p",[t._v("Spring Boot Actuator可以在运行时查看和配置应用程序的日志级别。您可以查看整个列表，也可以查看单个记录器的配置，该配置由显式配置的记录级别以及由记录框架赋予它的有效记录级别组成。这些级别可以是以下之一：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("TRACE")])]),t._v(" "),e("li",[e("code",[t._v("DEBUG")])]),t._v(" "),e("li",[e("code",[t._v("INFO")])]),t._v(" "),e("li",[e("code",[t._v("WARN")])]),t._v(" "),e("li",[e("code",[t._v("ERROR")])]),t._v(" "),e("li",[e("code",[t._v("FATAL")])]),t._v(" "),e("li",[e("code",[t._v("OFF")])]),t._v(" "),e("li",[e("code",[t._v("null")])])]),t._v(" "),e("p",[e("code",[t._v("null")]),t._v(" 表示没有显式配置。")]),t._v(" "),e("h3",{attrs:{id:"_5-1。配置记录器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1。配置记录器"}},[t._v("#")]),t._v(" 5.1。配置记录器")]),t._v(" "),e("p",[t._v("要配置给定的记录器，"),e("code",[t._v("POST")]),t._v("它是资源URI的部分实体，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"configuredLevel"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DEBUG"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("要“重置”记录器的特定级别（并使用默认配置），可以将值传递"),e("code",[t._v("null")]),t._v("为"),e("code",[t._v("configuredLevel")]),t._v("。")])]),t._v(" "),e("h2",{attrs:{id:"_6-指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-指标"}},[t._v("#")]),t._v(" 6.指标")]),t._v(" "),e("p",[t._v("Spring Boot Actuator为"),e("a",{attrs:{href:"https://micrometer.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Micrometer"),e("OutboundLink")],1),t._v("提供了依赖项管理和自动配置，"),e("a",{attrs:{href:"https://micrometer.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Micrometer"),e("OutboundLink")],1),t._v("是一种支持大量监视系统的应用程序度量外观，包括：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-appoptics",target:"_blank",rel:"noopener noreferrer"}},[t._v("AppOptics"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-atlas",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿特拉斯"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-datadog",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据狗"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-dynatrace",target:"_blank",rel:"noopener noreferrer"}},[t._v("动态痕迹"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-elastic",target:"_blank",rel:"noopener noreferrer"}},[t._v("有弹性"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-ganglia",target:"_blank",rel:"noopener noreferrer"}},[t._v("神经节"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-graphite",target:"_blank",rel:"noopener noreferrer"}},[t._v("石墨"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-humio",target:"_blank",rel:"noopener noreferrer"}},[t._v("悍马"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-influx",target:"_blank",rel:"noopener noreferrer"}},[t._v("涌入"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-jmx",target:"_blank",rel:"noopener noreferrer"}},[t._v("JMX"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-kairos",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kairos数据库"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-newrelic",target:"_blank",rel:"noopener noreferrer"}},[t._v("新遗物"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-prometheus",target:"_blank",rel:"noopener noreferrer"}},[t._v("普罗米修斯"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-signalfx",target:"_blank",rel:"noopener noreferrer"}},[t._v("信号交换"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-simple",target:"_blank",rel:"noopener noreferrer"}},[t._v("简单（内存中）"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-statsd",target:"_blank",rel:"noopener noreferrer"}},[t._v("统计数据"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-export-wavefront",target:"_blank",rel:"noopener noreferrer"}},[t._v("波前"),e("OutboundLink")],1)])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("要了解有关Micrometer功能的更多信息，请参阅其"),e("a",{attrs:{href:"https://micrometer.io/docs",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文档"),e("OutboundLink")],1),t._v("，特别是"),e("a",{attrs:{href:"https://micrometer.io/docs/concepts",target:"_blank",rel:"noopener noreferrer"}},[t._v("概念部分"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("h3",{attrs:{id:"_6-1。入门"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-1。入门"}},[t._v("#")]),t._v(" 6.1。入门")]),t._v(" "),e("p",[t._v("Spring Boot自动配置组合，"),e("code",[t._v("MeterRegistry")]),t._v("并为其在类路径上找到的每个受支持的实现向组合添加注册表。在"),e("code",[t._v("micrometer-registry-{system}")]),t._v("运行时类路径中具有依赖项足以让Spring Boot配置注册表。")]),t._v(" "),e("p",[t._v("大多数注册表具有共同的特征。例如，即使Micrometer注册表实现位于类路径中，您也可以禁用特定的注册表。例如，禁用Datadog：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.datadog.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("p",[t._v("Spring Boot还会将任何自动配置的注册表添加到"),e("code",[t._v("Metrics")]),t._v("该类的全局静态复合注册表中，除非您明确告诉它不要：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.use-global-registry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("p",[t._v("您可以注册任意数量的"),e("code",[t._v("MeterRegistryCustomizer")]),t._v("bean来进一步配置注册表，例如在向注册表注册任何计量器之前应用通用标签：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistryCustomizer")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("metricsCommonTags")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" registry "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("config")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("commonTags")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"region"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"us-east-1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("您可以通过更具体地了解通用类型，将自定义项应用于特定的注册表实现：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistryCustomizer")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GraphiteMeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("graphiteMetricsNamingConvention")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" registry "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("config")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("namingConvention")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MY_CUSTOM_CONVENTION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("完成该设置后，您可以注入"),e("code",[t._v("MeterRegistry")]),t._v("组件并注册指标：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SampleBean")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Counter")]),t._v(" counter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SampleBean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistry")]),t._v(" registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("counter "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("counter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"received.messages"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("counter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// handle message implementation")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Spring Boot还"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-meter",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置了内置工具"),e("OutboundLink")],1),t._v("（即"),e("code",[t._v("MeterBinder")]),t._v("实现），您可以通过配置或专用注释标记来控制它们。")]),t._v(" "),e("h3",{attrs:{id:"_6-2。支持的监控系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2。支持的监控系统"}},[t._v("#")]),t._v(" 6.2。支持的监控系统")]),t._v(" "),e("h4",{attrs:{id:"_6-2-1。appoptics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1。appoptics"}},[t._v("#")]),t._v(" 6.2.1。AppOptics")]),t._v(" "),e("p",[t._v("默认情况下，AppOptics注册表"),e("code",[t._v("api.appoptics.com/v1/measurements")]),t._v("定期推送指标。要将指标导出到SaaS "),e("a",{attrs:{href:"https://micrometer.io/docs/registry/appoptics",target:"_blank",rel:"noopener noreferrer"}},[t._v("AppOptics"),e("OutboundLink")],1),t._v("，必须提供您的API令牌：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.appoptics.api-token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_TOKEN")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-2。阿特拉斯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-2。阿特拉斯"}},[t._v("#")]),t._v(" 6.2.2。阿特拉斯")]),t._v(" "),e("p",[t._v("默认情况下，度量标准将导出到在本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/atlas",target:"_blank",rel:"noopener noreferrer"}},[t._v("Atlas"),e("OutboundLink")],1),t._v("。可以使用以下命令提供要使用的"),e("a",{attrs:{href:"https://github.com/Netflix/atlas",target:"_blank",rel:"noopener noreferrer"}},[t._v("Atlas服务器"),e("OutboundLink")],1),t._v("的位置：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.atlas.uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("https://atlas.example.com:7101/api/v1/publish")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-3。数据狗"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-3。数据狗"}},[t._v("#")]),t._v(" 6.2.3。数据狗")]),t._v(" "),e("p",[t._v("Datadog注册表"),e("a",{attrs:{href:"https://www.datadoghq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("会"),e("OutboundLink")],1),t._v("定期将指标推送到"),e("a",{attrs:{href:"https://www.datadoghq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("datadoghq"),e("OutboundLink")],1),t._v("。要将指标导出到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/datadog",target:"_blank",rel:"noopener noreferrer"}},[t._v("Datadog"),e("OutboundLink")],1),t._v("，必须提供您的API密钥：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.datadog.api-key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_KEY")]),t._v("\n")])])]),e("p",[t._v("您还可以更改将度量标准发送到Datadog的时间间隔：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.datadog.step")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("30s")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-4。动态痕迹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-4。动态痕迹"}},[t._v("#")]),t._v(" 6.2.4。动态痕迹")]),t._v(" "),e("p",[t._v("Dynatrace注册表会定期将指标推送到配置的URI。要将指标导出到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/dynatrace",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dynatrace"),e("OutboundLink")],1),t._v("，必须提供您的API令牌，设备ID和URI：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.dynatrace.api-token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_TOKEN")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.dynatrace.device-id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_DEVICE_ID")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.dynatrace.uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_URI")]),t._v("\n")])])]),e("p",[t._v("您还可以更改将度量标准发送到Dynatrace的时间间隔：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.dynatrace.step")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("30s")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-5。有弹性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-5。有弹性"}},[t._v("#")]),t._v(" 6.2.5。有弹性")]),t._v(" "),e("p",[t._v("默认情况下，指标会导出到在本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/elastic",target:"_blank",rel:"noopener noreferrer"}},[t._v("Elastic"),e("OutboundLink")],1),t._v("。可以使用以下属性提供要使用的Elastic服务器的位置：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.elastic.host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("https://elastic.example.com:8086")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-6。神经节"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-6。神经节"}},[t._v("#")]),t._v(" 6.2.6。神经节")]),t._v(" "),e("p",[t._v("默认情况下，指标将导出到在本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/ganglia",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ganglia"),e("OutboundLink")],1),t._v("。可以使用以下命令提供要使用的"),e("a",{attrs:{href:"http://ganglia.sourceforge.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ganglia服务器"),e("OutboundLink")],1),t._v("主机和端口：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.ganglia.host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("ganglia.example.com")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.ganglia.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("9649")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-7。石墨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-7。石墨"}},[t._v("#")]),t._v(" 6.2.7。石墨")]),t._v(" "),e("p",[t._v("默认情况下，指标会导出到本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/graphite",target:"_blank",rel:"noopener noreferrer"}},[t._v("Graphite"),e("OutboundLink")],1),t._v("。可以使用以下方式提供要使用的"),e("a",{attrs:{href:"https://graphiteapp.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Graphite服务器"),e("OutboundLink")],1),t._v("主机和端口：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.graphite.host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("graphite.example.com")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.graphite.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("9004")]),t._v("\n")])])]),e("p",[t._v("千分尺提供了一个默认值"),e("code",[t._v("HierarchicalNameMapper")]),t._v("，用于控制如何将尺寸仪表ID "),e("a",{attrs:{href:"https://micrometer.io/docs/registry/graphite#_hierarchical_name_mapping",target:"_blank",rel:"noopener noreferrer"}},[t._v("映射到平面层次名称"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("要控制这种行为，请定义您自己的"),e("code",[t._v("GraphiteMeterRegistry")]),t._v("并提供您自己的"),e("code",[t._v("HierarchicalNameMapper")]),t._v("。除非您定义自己的，否则将提供自动配置的bean "),e("code",[t._v("GraphiteConfig")]),t._v("和"),e("code",[t._v("Clock")]),t._v("bean：")])]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GraphiteMeterRegistry")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("graphiteMeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GraphiteConfig")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Clock")]),t._v(" clock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GraphiteMeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MY_HIERARCHICAL_MAPPER"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-8。悍马"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-8。悍马"}},[t._v("#")]),t._v(" 6.2.8。悍马")]),t._v(" "),e("p",[t._v("默认情况下，Humio注册表"),e("a",{attrs:{href:"https://cloud.humio.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("会"),e("OutboundLink")],1),t._v("定期将指标推送到"),e("a",{attrs:{href:"https://cloud.humio.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cloud.humio.com"),e("OutboundLink")],1),t._v("。要将指标导出到SaaS "),e("a",{attrs:{href:"https://micrometer.io/docs/registry/humio",target:"_blank",rel:"noopener noreferrer"}},[t._v("Humio"),e("OutboundLink")],1),t._v("，必须提供您的API令牌：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.humio.api-token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_TOKEN")]),t._v("\n")])])]),e("p",[t._v("您还应该配置一个或多个标记以标识将度量标准推送到的数据源：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.humio.tags.alpha")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("a")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.humio.tags.bravo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("b")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-9。涌入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-9。涌入"}},[t._v("#")]),t._v(" 6.2.9。涌入")]),t._v(" "),e("p",[t._v("默认情况下，指标会导出到本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/influx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Influx"),e("OutboundLink")],1),t._v("。可使用以下命令提供要使用的"),e("a",{attrs:{href:"https://www.influxdata.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Influx服务器"),e("OutboundLink")],1),t._v("的位置：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.influx.uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("https://influx.example.com:8086")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-10。jmx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-10。jmx"}},[t._v("#")]),t._v(" 6.2.10。JMX")]),t._v(" "),e("p",[t._v("千分尺提供了到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/jmx",target:"_blank",rel:"noopener noreferrer"}},[t._v("JMX"),e("OutboundLink")],1),t._v("的层次结构映射，主要是作为一种便宜且可移植的方式在本地查看指标。默认情况下，指标会导出到"),e("code",[t._v("metrics")]),t._v("JMX域。可以使用以下方式提供要使用的域：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.jmx.domain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("com.example.app.metrics")]),t._v("\n")])])]),e("p",[t._v("千分尺提供了一个默认值"),e("code",[t._v("HierarchicalNameMapper")]),t._v("，用于控制如何将尺寸仪表ID "),e("a",{attrs:{href:"https://micrometer.io/docs/registry/jmx#_hierarchical_name_mapping",target:"_blank",rel:"noopener noreferrer"}},[t._v("映射到平面层次名称"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("要控制这种行为，请定义您自己的"),e("code",[t._v("JmxMeterRegistry")]),t._v("并提供您自己的"),e("code",[t._v("HierarchicalNameMapper")]),t._v("。除非您定义自己的，否则将提供自动配置的bean "),e("code",[t._v("JmxConfig")]),t._v("和"),e("code",[t._v("Clock")]),t._v("bean：")])]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JmxMeterRegistry")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("jmxMeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JmxConfig")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Clock")]),t._v(" clock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JmxMeterRegistry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" clock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MY_HIERARCHICAL_MAPPER"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-11。kairos数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-11。kairos数据库"}},[t._v("#")]),t._v(" 6.2.11。Kairos数据库")]),t._v(" "),e("p",[t._v("默认情况下，度量标准将导出到在本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/kairos",target:"_blank",rel:"noopener noreferrer"}},[t._v("KairosDB"),e("OutboundLink")],1),t._v("。可以使用以下方式提供"),e("a",{attrs:{href:"https://kairosdb.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("KairosDB服务器"),e("OutboundLink")],1),t._v("的使用位置：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.kairos.uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("https://kairosdb.example.com:8080/api/v1/datapoints")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-12。新遗物"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-12。新遗物"}},[t._v("#")]),t._v(" 6.2.12。新遗物")]),t._v(" "),e("p",[t._v("New Relic注册表会定期将指标推送到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/new-relic",target:"_blank",rel:"noopener noreferrer"}},[t._v("New Relic"),e("OutboundLink")],1),t._v("。要将指标导出到"),e("a",{attrs:{href:"https://newrelic.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("New Relic"),e("OutboundLink")],1),t._v("，必须提供您的API密钥和帐户ID：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.newrelic.api-key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_KEY")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.newrelic.account-id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_ACCOUNT_ID")]),t._v("\n")])])]),e("p",[t._v("您还可以更改将度量标准发送到新遗物的时间间隔：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.newrelic.step")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("30s")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-13。普罗米修斯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-13。普罗米修斯"}},[t._v("#")]),t._v(" 6.2.13。普罗米修斯")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://micrometer.io/docs/registry/prometheus",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),e("OutboundLink")],1),t._v("希望抓取或轮询单个应用程序实例以获取指标。Spring Boot提供了一个执行器端点，可用于"),e("code",[t._v("/actuator/prometheus")]),t._v("以适当的格式显示"),e("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus刮擦"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("端点默认情况下不可用，必须公开，有关更多详细信息，请参见"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-exposing-endpoints",target:"_blank",rel:"noopener noreferrer"}},[t._v("暴露端点"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("p",[t._v("这是"),e("code",[t._v("scrape_config")]),t._v("要添加到的示例"),e("code",[t._v("prometheus.yml")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'spring'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metrics_path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/actuator/prometheus'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HOST:PORT'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("p",[t._v("对于短暂的或批处理的工作，其时间可能不够长，无法被"),e("a",{attrs:{href:"https://github.com/prometheus/pushgateway",target:"_blank",rel:"noopener noreferrer"}},[t._v("废弃，"),e("OutboundLink")],1),t._v("可以使用"),e("a",{attrs:{href:"https://github.com/prometheus/pushgateway",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus Pushgateway"),e("OutboundLink")],1),t._v("支持将其指标暴露给Prometheus。要启用Prometheus Pushgateway支持，请在项目中添加以下依赖项：")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("io.prometheus"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("simpleclient_pushgateway"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("当在类路径中存在Prometheus Pushgateway依赖项时，Spring Boot会自动配置"),e("code",[t._v("PrometheusPushGatewayManager")]),t._v("Bean。这可以管理将指标推送到Prometheus Pushgateway。在"),e("code",[t._v("PrometheusPushGatewayManager")]),t._v("可以在使用属性被调谐"),e("code",[t._v("management.metrics.export.prometheus.pushgateway")]),t._v("。对于高级配置，您还可以提供自己的"),e("code",[t._v("PrometheusPushGatewayManager")]),t._v("bean。")]),t._v(" "),e("h4",{attrs:{id:"_6-2-14。信号交换"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-14。信号交换"}},[t._v("#")]),t._v(" 6.2.14。信号交换")]),t._v(" "),e("p",[t._v("SignalFx注册表"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/signalfx",target:"_blank",rel:"noopener noreferrer"}},[t._v("会"),e("OutboundLink")],1),t._v("定期将指标推送到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/signalfx",target:"_blank",rel:"noopener noreferrer"}},[t._v("SignalFx"),e("OutboundLink")],1),t._v("。要将指标导出到"),e("a",{attrs:{href:"https://www.signalfx.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SignalFx"),e("OutboundLink")],1),t._v("，必须提供您的访问令牌：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.signalfx.access-token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_ACCESS_TOKEN")]),t._v("\n")])])]),e("p",[t._v("您还可以更改将度量标准发送到SignalFx的时间间隔：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.signalfx.step")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("30s")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-15。简单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-15。简单"}},[t._v("#")]),t._v(" 6.2.15。简单")]),t._v(" "),e("p",[t._v("千分尺附带一个简单的内存后端，如果未配置其他注册表，该后端将自动用作后备。这使您可以查看在"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-endpoint",target:"_blank",rel:"noopener noreferrer"}},[t._v("度量标准端点"),e("OutboundLink")],1),t._v("中收集了哪些度量"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-metrics-endpoint",target:"_blank",rel:"noopener noreferrer"}},[t._v("标准"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("使用任何其他可用后端时，内存后端都会自行禁用。您也可以显式禁用它：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.simple.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-16。统计数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-16。统计数据"}},[t._v("#")]),t._v(" 6.2.16。统计数据")]),t._v(" "),e("p",[t._v("StatsD注册表急切地通过UDP将度量标准推送到StatsD代理。默认情况下，指标会导出到本地计算机上运行的"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/statsd",target:"_blank",rel:"noopener noreferrer"}},[t._v("StatsD"),e("OutboundLink")],1),t._v("代理。可以使用以下方式提供要使用的StatsD代理主机和端口：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.statsd.host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("statsd.example.com")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.statsd.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("9125")]),t._v("\n")])])]),e("p",[t._v("您还可以更改要使用的StatsD线路协议（默认为Datadog）：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.statsd.flavor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("etsy")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-2-17。波前"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-17。波前"}},[t._v("#")]),t._v(" 6.2.17。波前")]),t._v(" "),e("p",[t._v("Wavefront注册表会定期将指标推送到"),e("a",{attrs:{href:"https://micrometer.io/docs/registry/wavefront",target:"_blank",rel:"noopener noreferrer"}},[t._v("Wavefront"),e("OutboundLink")],1),t._v("。如果直接将指标导出到"),e("a",{attrs:{href:"https://www.wavefront.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Wavefront"),e("OutboundLink")],1),t._v("，则必须提供API令牌：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.wavefront.api-token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("YOUR_API_TOKEN")]),t._v("\n")])])]),e("p",[t._v("或者，您可以使用在您的环境中设置的Wavefront边车或内部代理，将指标数据转发到Wavefront API主机：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.wavefront.uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("proxy://localhost:2878")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果将指标发布到Wavefront代理（如"),e("a",{attrs:{href:"https://docs.wavefront.com/proxies_installing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),e("OutboundLink")],1),t._v("中"),e("a",{attrs:{href:"https://docs.wavefront.com/proxies_installing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("所述"),e("OutboundLink")],1),t._v("），则主机必须采用以下"),e("code",[t._v("proxy://HOST:PORT")]),t._v("格式。")])]),t._v(" "),e("p",[t._v("您还可以更改将度量标准发送到Wavefront的时间间隔：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.export.wavefront.step")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("30s")]),t._v("\n")])])]),e("h3",{attrs:{id:"_6-3。支持的指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3。支持的指标"}},[t._v("#")]),t._v(" 6.3。支持的指标")]),t._v(" "),e("p",[t._v("如果适用，Spring Boot将注册以下核心指标：")]),t._v(" "),e("ul",[e("li",[t._v("JVM指标，报告以下各项的利用率：\n"),e("ul",[e("li",[t._v("各种内存和缓冲池")]),t._v(" "),e("li",[t._v("与垃圾收集有关的统计数据")]),t._v(" "),e("li",[t._v("线程利用率")]),t._v(" "),e("li",[t._v("加载/卸载的类数")])])]),t._v(" "),e("li",[t._v("CPU指标")]),t._v(" "),e("li",[t._v("文件描述符指标")]),t._v(" "),e("li",[t._v("卡夫卡消费者指标")]),t._v(" "),e("li",[t._v("Log4j2指标：记录每个级别记录到Log4j2的事件数")]),t._v(" "),e("li",[t._v("Logback指标：记录每个级别记录到Logback的事件数")]),t._v(" "),e("li",[t._v("正常运行时间指标：报告正常运行时间的量度和代表应用程序绝对启动时间的固定量度")]),t._v(" "),e("li",[t._v("Tomcat指标（"),e("code",[t._v("server.tomcat.mbeanregistry.enabled")]),t._v("必须设置"),e("code",[t._v("true")]),t._v("为才能注册所有Tomcat指标）")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-integration/docs/5.2.2.RELEASE/reference/html/system-management.html#micrometer-integration",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring集成"),e("OutboundLink")],1),t._v("指标")])]),t._v(" "),e("h4",{attrs:{id:"_6-3-1。spring-mvc指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-1。spring-mvc指标"}},[t._v("#")]),t._v(" 6.3.1。Spring MVC指标")]),t._v(" "),e("p",[t._v("通过自动配置，可以检测由Spring MVC处理的请求。当"),e("code",[t._v("management.metrics.web.server.request.autotime.enabled")]),t._v("为时"),e("code",[t._v("true")]),t._v("，将对所有请求进行这种检测。或者，当设置为时，"),e("code",[t._v("false")]),t._v("可以通过添加"),e("code",[t._v("@Timed")]),t._v("到请求处理方法来启用检测：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyController")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/api/people"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("extraTags "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"region"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"us-east-1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all.people"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" longTask "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("listPeople")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("控制器类，用于对控制器中的每个请求处理程序启用计时。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("一种启用单个端点的方法。如果您将它放在类中，则不必这样做，但是可以用于进一步为此特定端点自定义计时器。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("一种"),e("code",[t._v("longTask = true")]),t._v("用于为该方法启用长任务计时器的方法。长任务计时器需要一个单独的度量标准名称，并且可以与短任务计时器堆叠在一起。")])]),t._v(" "),e("p",[t._v("默认情况下，指标名称为"),e("code",[t._v("http.server.requests")]),t._v("。可以通过设置"),e("code",[t._v("management.metrics.web.server.request.metric-name")]),t._v("属性来自定义名称。")]),t._v(" "),e("p",[t._v("默认情况下，与Spring MVC相关的指标带有以下信息标记：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("标签")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("exception")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("处理请求时引发的任何异常的简单类名。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("method")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("请求的方法（例如"),e("code",[t._v("GET")]),t._v("或"),e("code",[t._v("POST")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("outcome")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("基于响应状态码的请求结果。1xx是"),e("code",[t._v("INFORMATIONAL")]),t._v("，2xx是"),e("code",[t._v("SUCCESS")]),t._v("，3xx是"),e("code",[t._v("REDIRECTION")]),t._v("，4xx "),e("code",[t._v("CLIENT_ERROR")]),t._v("和5xx是"),e("code",[t._v("SERVER_ERROR")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("status")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("响应的HTTP状态代码（例如"),e("code",[t._v("200")]),t._v("或"),e("code",[t._v("500")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("变量替换之前的请求URI模板（如果可能）（例如，"),e("code",[t._v("/api/person/{id}")]),t._v("）")])])])]),t._v(" "),e("p",[t._v("要自定义标签，请提供"),e("code",[t._v("@Bean")]),t._v("实现的"),e("code",[t._v("WebMvcTagsProvider")]),t._v("。")]),t._v(" "),e("h4",{attrs:{id:"_6-3-2。spring-webflux指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-2。spring-webflux指标"}},[t._v("#")]),t._v(" 6.3.2。Spring WebFlux指标")]),t._v(" "),e("p",[t._v("通过自动配置，可以检测WebFlux控制器和功能处理程序处理的所有请求。")]),t._v(" "),e("p",[t._v("默认情况下，使用名称生成指标"),e("code",[t._v("http.server.requests")]),t._v("。您可以通过设置"),e("code",[t._v("management.metrics.web.server.request.metric-name")]),t._v("属性来自定义名称。")]),t._v(" "),e("p",[t._v("默认情况下，与WebFlux相关的度量标准标记有以下信息：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("标签")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("exception")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("处理请求时引发的任何异常的简单类名。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("method")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("请求的方法（例如"),e("code",[t._v("GET")]),t._v("或"),e("code",[t._v("POST")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("outcome")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("基于响应状态码的请求结果。1xx是"),e("code",[t._v("INFORMATIONAL")]),t._v("，2xx是"),e("code",[t._v("SUCCESS")]),t._v("，3xx是"),e("code",[t._v("REDIRECTION")]),t._v("，4xx "),e("code",[t._v("CLIENT_ERROR")]),t._v("和5xx是"),e("code",[t._v("SERVER_ERROR")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("status")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("响应的HTTP状态代码（例如"),e("code",[t._v("200")]),t._v("或"),e("code",[t._v("500")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("变量替换之前的请求URI模板（如果可能）（例如，"),e("code",[t._v("/api/person/{id}")]),t._v("）")])])])]),t._v(" "),e("p",[t._v("要自定义标签，请提供"),e("code",[t._v("@Bean")]),t._v("实现的"),e("code",[t._v("WebFluxTagsProvider")]),t._v("。")]),t._v(" "),e("h4",{attrs:{id:"_6-3-3。泽西岛服务器指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-3。泽西岛服务器指标"}},[t._v("#")]),t._v(" 6.3.3。泽西岛服务器指标")]),t._v(" "),e("p",[t._v("当Micrometer的"),e("code",[t._v("micrometer-jersey2")]),t._v("模块位于类路径上时，自动配置将启用对Jersey JAX-RS实现所处理的请求的检测。当"),e("code",[t._v("management.metrics.web.server.request.autotime.enabled")]),t._v("为时"),e("code",[t._v("true")]),t._v("，将对所有请求进行这种检测。或者，当设置为时，"),e("code",[t._v("false")]),t._v("可以通过添加"),e("code",[t._v("@Timed")]),t._v("到请求处理方法来启用检测：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/api/people"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Endpoint")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GET")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("extraTags "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"region"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"us-east-1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Timed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all.people"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" longTask "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("listPeople")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("在资源类上，以对资源中的每个请求处理程序启用计时。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("关于启用单个端点的方法。如果您将它放在类中，则不必这样做，但是可以用于进一步为此特定端点自定义计时器。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("具有"),e("code",[t._v("longTask = true")]),t._v("启用该方法的长任务计时器的方法。长任务计时器需要一个单独的度量标准名称，并且可以与短任务计时器堆叠在一起。")])]),t._v(" "),e("p",[t._v("默认情况下，指标名称为"),e("code",[t._v("http.server.requests")]),t._v("。可以通过设置"),e("code",[t._v("management.metrics.web.server.request.metric-name")]),t._v("属性来自定义名称。")]),t._v(" "),e("p",[t._v("默认情况下，Jersey服务器指标带有以下信息：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("标签")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("exception")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("处理请求时引发的任何异常的简单类名。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("method")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("请求的方法（例如"),e("code",[t._v("GET")]),t._v("或"),e("code",[t._v("POST")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("outcome")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("基于响应状态码的请求结果。1xx是"),e("code",[t._v("INFORMATIONAL")]),t._v("，2xx是"),e("code",[t._v("SUCCESS")]),t._v("，3xx是"),e("code",[t._v("REDIRECTION")]),t._v("，4xx "),e("code",[t._v("CLIENT_ERROR")]),t._v("和5xx是"),e("code",[t._v("SERVER_ERROR")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("status")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("响应的HTTP状态代码（例如"),e("code",[t._v("200")]),t._v("或"),e("code",[t._v("500")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("变量替换之前的请求URI模板（如果可能）（例如，"),e("code",[t._v("/api/person/{id}")]),t._v("）")])])])]),t._v(" "),e("p",[t._v("要自定义标签，请提供"),e("code",[t._v("@Bean")]),t._v("实现的"),e("code",[t._v("JerseyTagsProvider")]),t._v("。")]),t._v(" "),e("h4",{attrs:{id:"_6-3-4。http客户端指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-4。http客户端指标"}},[t._v("#")]),t._v(" 6.3.4。HTTP客户端指标")]),t._v(" "),e("p",[t._v("春季启动器同时管理的仪表"),e("code",[t._v("RestTemplate")]),t._v("和"),e("code",[t._v("WebClient")]),t._v("。为此，您必须注入自动配置的构建器并使用它来创建实例：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("RestTemplateBuilder")]),t._v(" 对于 "),e("code",[t._v("RestTemplate")])]),t._v(" "),e("li",[e("code",[t._v("WebClient.Builder")]),t._v(" 对于 "),e("code",[t._v("WebClient")])])]),t._v(" "),e("p",[t._v("也可以手动应用负责此工具的定制程序，即"),e("code",[t._v("MetricsRestTemplateCustomizer")]),t._v("和"),e("code",[t._v("MetricsWebClientCustomizer")]),t._v("。")]),t._v(" "),e("p",[t._v("默认情况下，指标名称为"),e("code",[t._v("http.client.requests")]),t._v("。可以通过设置"),e("code",[t._v("management.metrics.web.client.request.metric-name")]),t._v("属性来自定义名称。")]),t._v(" "),e("p",[t._v("默认情况下，通过检测的客户端生成的指标会标记以下信息：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("标签")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("clientName")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("URI的主机部分")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("method")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("请求的方法（例如"),e("code",[t._v("GET")]),t._v("或"),e("code",[t._v("POST")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("outcome")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("基于响应状态码的请求结果。1xx是"),e("code",[t._v("INFORMATIONAL")]),t._v("，2xx是"),e("code",[t._v("SUCCESS")]),t._v("，3xx是"),e("code",[t._v("REDIRECTION")]),t._v("，4xx "),e("code",[t._v("CLIENT_ERROR")]),t._v("和5xx是"),e("code",[t._v("SERVER_ERROR")]),t._v("，"),e("code",[t._v("UNKNOWN")]),t._v("否则")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("status")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("响应的HTTP状态代码（例如"),e("code",[t._v("200")]),t._v("或"),e("code",[t._v("500")]),t._v("）（"),e("code",[t._v("IO_ERROR")]),t._v("如果存在I / O问题），"),e("code",[t._v("CLIENT_ERROR")]),t._v("否则")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("变量替换之前的请求URI模板（如果可能）（例如，"),e("code",[t._v("/api/person/{id}")]),t._v("）")])])])]),t._v(" "),e("p",[t._v("要自定义标签，并根据您选择的客户端，可以提供"),e("code",[t._v("@Bean")]),t._v("实现"),e("code",[t._v("RestTemplateExchangeTagsProvider")]),t._v("或的"),e("code",[t._v("WebClientExchangeTagsProvider")]),t._v("。有方便的静态函数中"),e("code",[t._v("RestTemplateExchangeTags")]),t._v("和"),e("code",[t._v("WebClientExchangeTags")]),t._v("。")]),t._v(" "),e("h4",{attrs:{id:"_6-3-5。缓存指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-5。缓存指标"}},[t._v("#")]),t._v(" 6.3.5。缓存指标")]),t._v(" "),e("p",[t._v("通过自动配置，可以"),e("code",[t._v("Cache")]),t._v("在启动时使用前缀为的指标来检测所有可用的"),e("code",[t._v("cache")]),t._v("。高速缓存检测针对一组基本指标进行了标准化。还提供其他特定于缓存的指标。")]),t._v(" "),e("p",[t._v("支持以下缓存库：")]),t._v(" "),e("ul",[e("li",[t._v("咖啡因")]),t._v(" "),e("li",[t._v("高速缓存2")]),t._v(" "),e("li",[t._v("淡褐色")]),t._v(" "),e("li",[t._v("任何兼容的JCache（JSR-107）实现")])]),t._v(" "),e("p",[t._v("度量标准由高速缓存的名称以及"),e("code",[t._v("CacheManager")]),t._v("从Bean名称派生的的名称标记。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("只有启动时可用的缓存才绑定到注册表。对于在启动阶段后即时或以编程方式创建的缓存，需要显式注册。可以使用"),e("code",[t._v("CacheMetricsRegistrar")]),t._v("Bean来简化该过程。")])]),t._v(" "),e("h4",{attrs:{id:"_6-3-6。数据源指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-6。数据源指标"}},[t._v("#")]),t._v(" 6.3.6。数据源指标")]),t._v(" "),e("p",[t._v("自动配置可"),e("code",[t._v("DataSource")]),t._v("使用前缀为的度量来检测所有可用对象"),e("code",[t._v("jdbc.connections")]),t._v("。数据源检测产生的量规表示池中当前活动，空闲，最大允许和最小允许的连接。")]),t._v(" "),e("p",[t._v("度量标准还通过"),e("code",[t._v("DataSource")]),t._v("基于bean名称的计算名称来标记。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("默认情况下，Spring Boot为所有支持的数据源提供元数据。"),e("code",[t._v("DataSourcePoolMetadataProvider")]),t._v("如果不支持立即使用您喜欢的数据源，则可以添加其他bean。请参阅"),e("code",[t._v("DataSourcePoolMetadataProvidersConfiguration")]),t._v("示例。")])]),t._v(" "),e("p",[t._v("此外，特定于Hikari的指标带有"),e("code",[t._v("hikaricp")]),t._v("前缀。每个度量标准都以“池”的名称标记（可以通过来控制"),e("code",[t._v("spring.datasource.name")]),t._v("）。")]),t._v(" "),e("h4",{attrs:{id:"_6-3-7。休眠指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-7。休眠指标"}},[t._v("#")]),t._v(" 6.3.7。休眠指标")]),t._v(" "),e("p",[t._v("通过自动配置，可以检测所有可用"),e("code",[t._v("EntityManagerFactory")]),t._v("统计指标（名为）启用的可用Hibernate 实例"),e("code",[t._v("hibernate")]),t._v("。")]),t._v(" "),e("p",[t._v("指标也由"),e("code",[t._v("EntityManagerFactory")]),t._v("从Bean名称派生的的名称进行标记。")]),t._v(" "),e("p",[t._v("要启用统计信息，"),e("code",[t._v("hibernate.generate_statistics")]),t._v("必须将标准JPA属性设置为"),e("code",[t._v("true")]),t._v("。您可以在自动配置中启用该功能，"),e("code",[t._v("EntityManagerFactory")]),t._v("如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("spring.jpa.properties.hibernate.generate_statistics")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-3-8。rabbitmq指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-8。rabbitmq指标"}},[t._v("#")]),t._v(" 6.3.8。RabbitMQ指标")]),t._v(" "),e("p",[t._v("自动配置将启用名为的度量标准来检测所有可用的RabbitMQ连接工厂"),e("code",[t._v("rabbitmq")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"_6-4。注册自定义指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-4。注册自定义指标"}},[t._v("#")]),t._v(" 6.4。注册自定义指标")]),t._v(" "),e("p",[t._v("要注册自定义指标，请插入"),e("code",[t._v("MeterRegistry")]),t._v("到您的组件中，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dictionary")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" words "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CopyOnWriteArrayList")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dictionary")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistry")]),t._v(" registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("gaugeCollectionSize")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dictionary.size"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tags")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("empty")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("words"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// …")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("如果发现您反复在组件或应用程序中检测一组度量标准，则可以将此套件封装在"),e("code",[t._v("MeterBinder")]),t._v("实现中。默认情况下，所有"),e("code",[t._v("MeterBinder")]),t._v("bean的度量标准都将自动绑定到Spring-managed "),e("code",[t._v("MeterRegistry")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"_6-5。自定义单个指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-5。自定义单个指标"}},[t._v("#")]),t._v(" 6.5。自定义单个指标")]),t._v(" "),e("p",[t._v("如果需要将自定义应用于特定"),e("code",[t._v("Meter")]),t._v("实例，则可以使用该"),e("code",[t._v("io.micrometer.core.instrument.config.MeterFilter")]),t._v("界面。默认情况下，所有"),e("code",[t._v("MeterFilter")]),t._v("bean都会自动应用于千分尺"),e("code",[t._v("MeterRegistry.Config")]),t._v("。")]),t._v(" "),e("p",[t._v("例如，如果要将所有仪表ID 的"),e("code",[t._v("mytag.region")]),t._v("标签重命名"),e("code",[t._v("mytag.area")]),t._v("为"),e("code",[t._v("com.example")]),t._v("，则可以执行以下操作：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterFilter")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("renameRegionTagMeterFilter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterFilter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("renameTag")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.example"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mytag.region"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mytag.area"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"_6-5-1。常用标签"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-1。常用标签"}},[t._v("#")]),t._v(" 6.5.1。常用标签")]),t._v(" "),e("p",[t._v("通用标签通常用于在操作环境（如主机，实例，区域，堆栈等）上进行维度深入分析。通用标签适用于所有仪表，并可以按以下示例所示进行配置：")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.tags.region")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("us-east-1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.tags.stack")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("prod")]),t._v("\n")])])]),e("p",[t._v("上面的示例将"),e("code",[t._v("region")]),t._v("和"),e("code",[t._v("stack")]),t._v("标记分别添加到"),e("code",[t._v("us-east-1")]),t._v("和"),e("code",[t._v("prod")]),t._v("分别具有和的所有仪表。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果使用Graphite，则常用标签的顺序很重要。由于使用这种方法不能保证通用标签的顺序，因此建议石墨用户定义一个自定义"),e("code",[t._v("MeterFilter")]),t._v("。")])]),t._v(" "),e("h4",{attrs:{id:"_6-5-2。每米属性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-2。每米属性"}},[t._v("#")]),t._v(" 6.5.2。每米属性")]),t._v(" "),e("p",[t._v("除了"),e("code",[t._v("MeterFilter")]),t._v("bean，还可以使用属性在每米的基础上应用一组有限的自定义设置。每表定制适用于以给定名称开头的所有所有表ID。例如，以下将禁用所有ID以以下开头的仪表"),e("code",[t._v("example.remote")])]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.metrics.enable.example.remote")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("p",[t._v("以下属性允许按米自定义：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.metrics.enable")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是否拒绝仪表发出任何指标。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.metrics.distribution.percentiles-histogram")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是否发布适合于计算可凝集（跨维度）百分位数逼近的直方图。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.metrics.distribution.minimum-expected-value")]),t._v("， "),e("code",[t._v("management.metrics.distribution.maximum-expected-value")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("通过限制期望值的范围来发布较少的直方图桶。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.metrics.distribution.percentiles")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("发布在应用程序中计算的百分位值")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("management.metrics.distribution.sla")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("发布包含您的SLA定义的存储桶的累积直方图。")])])])]),t._v(" "),e("p",[t._v("有关概念的更多细节的背后"),e("code",[t._v("percentiles-histogram")]),t._v("，"),e("code",[t._v("percentiles")]),t._v("并"),e("code",[t._v("sla")]),t._v("请参阅"),e("a",{attrs:{href:"https://micrometer.io/docs/concepts#_histograms_and_percentiles",target:"_blank",rel:"noopener noreferrer"}},[t._v("“直方图和百分”部分"),e("OutboundLink")],1),t._v("微米文档。")]),t._v(" "),e("h3",{attrs:{id:"_6-6。指标终点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-6。指标终点"}},[t._v("#")]),t._v(" 6.6。指标终点")]),t._v(" "),e("p",[t._v("Spring Boot提供了一个"),e("code",[t._v("metrics")]),t._v("端点，可用于诊断检查应用程序收集的指标。端点默认情况下不可用，必须公开，有关更多详细信息，请参见"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-endpoints-exposing-endpoints",target:"_blank",rel:"noopener noreferrer"}},[t._v("暴露端点"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("导航以"),e("code",[t._v("/actuator/metrics")]),t._v("显示可用仪表名称的列表。您可以通过提供特定的仪表名称作为选择器来向下浏览以查看有关该仪表的信息"),e("code",[t._v("/actuator/metrics/jvm.memory.max")]),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("您在此处使用的名称应与代码中使用的名称相匹配，而不是已经针对其附带的监视系统进行了命名约定标准化后的名称。换句话说，如果由于其蛇形命名约定"),e("code",[t._v("jvm.memory.max")]),t._v("而"),e("code",[t._v("jvm_memory_max")]),t._v("在Prometheus中出现，则"),e("code",[t._v("jvm.memory.max")]),t._v("在检查"),e("code",[t._v("metrics")]),t._v("端点中的电表时仍应将其用作选择器。")])]),t._v(" "),e("p",[t._v("您还可以"),e("code",[t._v("tag=KEY:VALUE")]),t._v("在URL的末尾添加任意数量的查询参数，以在维度上进一步细分仪表，例如"),e("code",[t._v("/actuator/metrics/jvm.memory.max?tag=area:nonheap")]),t._v("。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("报告的测量值是与仪表名称和已应用的任何标签相匹配的所有仪表的统计信息的"),e("em",[t._v("总和")]),t._v("。因此，在上面的示例中，返回的“值”统计量是堆的“代码缓存”，“压缩类空间”和“元空间”区域的最大内存占用量的总和。如果您只想查看“ Metaspace”的最大大小，则可以添加一个额外的"),e("code",[t._v("tag=id:Metaspace")]),t._v("，即"),e("code",[t._v("/actuator/metrics/jvm.memory.max?tag=area:nonheap&tag=id:Metaspace")]),t._v("。")])]),t._v(" "),e("h2",{attrs:{id:"_7-审核"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-审核"}},[t._v("#")]),t._v(" 7.审核")]),t._v(" "),e("p",[t._v("一旦启动了Spring Security，Spring Boot Actuator将拥有一个灵活的审核框架来发布事件（默认情况下，“身份验证成功”，“失败”和“拒绝访问”异常）。此功能对于基于身份验证失败的报告和实施锁定策略非常有用。")]),t._v(" "),e("p",[t._v("可以通过"),e("code",[t._v("AuditEventRepository")]),t._v("在应用程序的配置中提供类型的bean来启用审核。为了方便起见，Spring Boot提供了一个"),e("code",[t._v("InMemoryAuditEventRepository")]),t._v("。 "),e("code",[t._v("InMemoryAuditEventRepository")]),t._v("功能有限，我们建议仅将其用于开发环境。对于生产环境，请考虑创建自己的替代"),e("code",[t._v("AuditEventRepository")]),t._v("实现。")]),t._v(" "),e("h3",{attrs:{id:"_7-1。定制审核"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-1。定制审核"}},[t._v("#")]),t._v(" 7.1。定制审核")]),t._v(" "),e("p",[t._v("要自定义发布的安全事件，可以提供自己的实现"),e("code",[t._v("AbstractAuthenticationAuditListener")]),t._v("和"),e("code",[t._v("AbstractAuthorizationAuditListener")]),t._v("。")]),t._v(" "),e("p",[t._v("您也可以将审核服务用于自己的业务事件。为此，可以将"),e("code",[t._v("AuditEventRepository")]),t._v("Bean注入您自己的组件中，然后直接使用它，也可以将其发布"),e("code",[t._v("AuditApplicationEvent")]),t._v("到Spring中"),e("code",[t._v("ApplicationEventPublisher")]),t._v("（通过实现"),e("code",[t._v("ApplicationEventPublisherAware")]),t._v("）。")]),t._v(" "),e("h2",{attrs:{id:"_8-http跟踪"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-http跟踪"}},[t._v("#")]),t._v(" 8. HTTP跟踪")]),t._v(" "),e("p",[t._v("可以通过"),e("code",[t._v("HttpTraceRepository")]),t._v("在应用程序的配置中提供类型的bean来启用HTTP跟踪。为了方便起见，Spring Boot提供了一个"),e("code",[t._v("InMemoryHttpTraceRepository")]),t._v("默认存储最后100个请求-响应交换的跟踪的。 "),e("code",[t._v("InMemoryHttpTraceRepository")]),t._v("与其他跟踪解决方案相比，它受到限制，我们建议仅将其用于开发环境。对于生产环境，建议使用可用于生产的跟踪或可观察性解决方案，例如Zipkin或Spring Cloud Sleuth。或者，创建自己的"),e("code",[t._v("HttpTraceRepository")]),t._v("满足您需求的产品。")]),t._v(" "),e("p",[t._v("该"),e("code",[t._v("httptrace")]),t._v("终端可以被用来获得关于被存储在请求-响应交换信息"),e("code",[t._v("HttpTraceRepository")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"_8-1。自定义http跟踪"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-1。自定义http跟踪"}},[t._v("#")]),t._v(" 8.1。自定义HTTP跟踪")]),t._v(" "),e("p",[t._v("要自定义每个跟踪中包含的项目，请使用"),e("code",[t._v("management.trace.http.include")]),t._v("配置属性。对于高级定制，请考虑注册您自己的"),e("code",[t._v("HttpExchangeTracer")]),t._v("实现。")]),t._v(" "),e("h2",{attrs:{id:"_9-过程监控"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-过程监控"}},[t._v("#")]),t._v(" 9.过程监控")]),t._v(" "),e("p",[t._v("在该"),e("code",[t._v("spring-boot")]),t._v("模块中，您可以找到两个类来创建文件，这些类通常对于过程监视很有用：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("ApplicationPidFileWriter")]),t._v("创建一个包含应用程序PID的文件（默认情况下，在应用程序目录中的文件名为"),e("code",[t._v("application.pid")]),t._v("）。")]),t._v(" "),e("li",[e("code",[t._v("WebServerPortFileWriter")]),t._v("创建一个文件（一个或多个），其中包含正在运行的Web服务器的端口（默认情况下，在应用程序目录中的文件名为"),e("code",[t._v("application.port")]),t._v("）。")])]),t._v(" "),e("p",[t._v("默认情况下，不会激活这些编写器，但是您可以启用：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-process-monitoring-configuration",target:"_blank",rel:"noopener noreferrer"}},[t._v("通过扩展配置"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/production-ready-features.html#production-ready-process-monitoring-programmatically",target:"_blank",rel:"noopener noreferrer"}},[t._v("以编程方式"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"_9-1。扩展配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1。扩展配置"}},[t._v("#")]),t._v(" 9.1。扩展配置")]),t._v(" "),e("p",[t._v("在该"),e("code",[t._v("META-INF/spring.factories")]),t._v("文件中，您可以激活写入PID文件的侦听器，如以下示例所示：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("org.springframework.context.ApplicationListener = \\\norg.springframework.boot.context.ApplicationPidFileWriter，\\\norg.springframework.boot.web.context.WebServerPortFileWriter\n")])])]),e("h3",{attrs:{id:"_9-2。以编程方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2。以编程方式"}},[t._v("#")]),t._v(" 9.2。以编程方式")]),t._v(" "),e("p",[t._v("您也可以通过调用"),e("code",[t._v("SpringApplication.addListeners(…)")]),t._v("方法并传递适当的"),e("code",[t._v("Writer")]),t._v("对象来激活侦听器。此方法还允许您自定义"),e("code",[t._v("Writer")]),t._v("构造函数中的文件名和路径。")]),t._v(" "),e("h2",{attrs:{id:"_10-cloud-foundry支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-cloud-foundry支持"}},[t._v("#")]),t._v(" 10. Cloud Foundry支持")]),t._v(" "),e("p",[t._v("Spring Boot的执行器模块包括额外的支持，当您将其部署到兼容的Cloud Foundry实例时就会激活。该"),e("code",[t._v("/cloudfoundryapplication")]),t._v("路径提供了通往所有"),e("code",[t._v("@Endpoint")]),t._v("bean 的替代安全路径。")]),t._v(" "),e("p",[t._v("扩展支持使Cloud Foundry管理UI（例如可用于查看已部署的应用程序的Web应用程序）增加了Spring Boot执行器信息。例如，应用程序状态页面可能包含完整的运行状况信息，而不是典型的“正在运行”或“已停止”状态。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[e("code",[t._v("/cloudfoundryapplication")]),t._v("普通用户不能直接访问 该路径。为了使用端点，必须将有效的UAA令牌与请求一起传递。")])]),t._v(" "),e("h3",{attrs:{id:"_10-1。禁用扩展的cloud-foundry执行器支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-1。禁用扩展的cloud-foundry执行器支持"}},[t._v("#")]),t._v(" 10.1。禁用扩展的Cloud Foundry执行器支持")]),t._v(" "),e("p",[t._v("如果要完全禁用"),e("code",[t._v("/cloudfoundryapplication")]),t._v("端点，可以将以下设置添加到"),e("code",[t._v("application.properties")]),t._v("文件中：")]),t._v(" "),e("p",[t._v("application.properties")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.cloudfoundry.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("false")]),t._v("\n")])])]),e("h3",{attrs:{id:"_10-2。cloud-foundry自签名证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-2。cloud-foundry自签名证书"}},[t._v("#")]),t._v(" 10.2。Cloud Foundry自签名证书")]),t._v(" "),e("p",[t._v("默认情况下，"),e("code",[t._v("/cloudfoundryapplication")]),t._v("端点的安全性验证会对各种Cloud Foundry服务进行SSL调用。如果您的Cloud Foundry UAA或Cloud Controller服务使用自签名证书，则需要设置以下属性：")]),t._v(" "),e("p",[t._v("application.properties")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("management.cloudfoundry.skip-ssl-validation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n")])])]),e("h3",{attrs:{id:"_10-3。自定义上下文路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-3。自定义上下文路径"}},[t._v("#")]),t._v(" 10.3。自定义上下文路径")]),t._v(" "),e("p",[t._v("如果服务器的上下文路径已配置为以外的任何其他值"),e("code",[t._v("/")]),t._v("，则Cloud Foundry端点在应用程序的根目录将不可用。例如，如果"),e("code",[t._v("server.servlet.context-path=/app")]),t._v("可以使用，Cloud Foundry端点将可用"),e("code",[t._v("/app/cloudfoundryapplication/*")]),t._v("。")]),t._v(" "),e("p",[t._v("如果您希望Cloud Foundry端点始终在处可用"),e("code",[t._v("/cloudfoundryapplication/*")]),t._v("，而与服务器的上下文路径无关，则需要在应用程序中进行显式配置。配置将根据所使用的Web服务器而有所不同。对于Tomcat，可以添加以下配置：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TomcatServletWebServerFactory")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("servletWebServerFactory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TomcatServletWebServerFactory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("prepareContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Host")]),t._v(" host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContextInitializer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" initializers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("prepareContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" initializers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StandardContext")]),t._v(" child "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StandardContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            child"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addLifecycleListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tomcat")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FixContextListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            child"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPath")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/cloudfoundryapplication"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContainerInitializer")]),t._v(" initializer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServletContextInitializer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getContextPath")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            child"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addServletContainerInitializer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("initializer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("emptySet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            child"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCrossContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addChild")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContainerInitializer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServletContextInitializer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" contextPath"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Servlet")]),t._v(" servlet "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GenericServlet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n            "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletRequest")]),t._v(" req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletResponse")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletException")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContext")]),t._v(" context "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServletContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contextPath"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRequestDispatcher")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/cloudfoundryapplication"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("forward")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addServlet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cloudfoundry"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" servlet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addMapping")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/*"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"_11-下一步阅读"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-下一步阅读"}},[t._v("#")]),t._v(" 11.下一步阅读")]),t._v(" "),e("p",[t._v("您可能需要阅读有关"),e("a",{attrs:{href:"https://graphiteapp.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Graphite"),e("OutboundLink")],1),t._v("等绘图工具的信息。")]),t._v(" "),e("p",[t._v("否则，您可以继续阅读"),e("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/html/deployment.html#deployment",target:"_blank",rel:"noopener noreferrer"}},[t._v("“部署选项”，"),e("OutboundLink")],1),t._v("或者继续阅读有关Spring Boot的"),e("em",[t._v("构建工具插件的")]),t._v("一些深入信息。")])])}),[],!1,null,null,null);a.default=n.exports}}]);